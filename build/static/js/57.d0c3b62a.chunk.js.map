{"version":3,"file":"static/js/57.d0c3b62a.chunk.js","mappings":"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","sources":["api/axiosInstance.js","admin/AdminLogin.jsx","admin/AdminProductList.js","admin/AdminProductEdit.js","admin/AddProduct.js","admin/AdminAnnouncements.js","admin/AdminPage.jsx"],"sourcesContent":["// src/api/axiosInstance.js\r\nimport axios from \"axios\";\r\n\r\n/**\r\n * axiosInstance.js (FINAL FIXED VERSION)\r\n *\r\n * ✔ Uses REACT_APP_API_BASE in production (Vercel build)\r\n * ✔ Falls back to localhost:4000 ONLY in local development\r\n * ✔ Prevents double /api/api issues\r\n * ✔ Ensures credentials (cookies) work for admin login\r\n */\r\n\r\nconst API_BASE =\r\n  process.env.REACT_APP_API_BASE ||\r\n  (window.location.hostname === \"localhost\"\r\n    ? \"http://localhost:4000\"\r\n    : \"https://seemati-backend.onrender.com\"); // <-- your Render backend URL\r\n\r\nconst axiosInstance = axios.create({\r\n  baseURL: API_BASE, // DO NOT add /api here (your code already uses /api/... endpoints)\r\n  withCredentials: true,\r\n  timeout: 60000,\r\n});\r\n\r\n// Optional: helpful console debug\r\naxiosInstance.interceptors.request.use(\r\n  (config) => {\r\n    // console.log(`[API] ${config.method.toUpperCase()} ${config.baseURL}${config.url}`);\r\n    return config;\r\n  },\r\n  (error) => Promise.reject(error)\r\n);\r\n\r\naxiosInstance.interceptors.response.use(\r\n  (response) => response,\r\n  (error) => {\r\n    // console.warn('[API ERROR]', error?.response?.status, error?.config?.url);\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default axiosInstance;\r\n","// src/admin/AdminLogin.jsx\r\nimport React, { useState } from \"react\";\r\n\r\n/**\r\n * Admin login (OTP)\r\n *\r\n * This component will attempt multiple candidate endpoints until one\r\n * responds successfully. That avoids deployment mismatches where the\r\n * backend mounted OTP at /api/otp or /api/auth or /otpRoutes etc.\r\n *\r\n * Replace the file directly, restart the frontend process and hard-refresh.\r\n */\r\n\r\nconst BACKEND_BASE =\r\n  process.env.REACT_APP_API_BASE ||\r\n  process.env.NEXT_PUBLIC_API_BASE ||\r\n  // fallback to the live backend you were using\r\n  \"https://seemati-backend.onrender.com\";\r\n\r\nexport default function AdminLogin() {\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [otp, setOtp] = useState(\"\");\r\n  const [stage, setStage] = useState(\"enter\"); // 'enter' | 'verify'\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [debug, setDebug] = useState(\"\"); // small debug info for the page\r\n\r\n  // Candidate endpoints (order matters: try common one first)\r\n  const endpointCandidates = [\r\n    `${BACKEND_BASE}/api/auth/send-otp`,\r\n    `${BACKEND_BASE}/api/otp/send`,\r\n    `${BACKEND_BASE}/api/otpRoutes/send`,\r\n    `${BACKEND_BASE}/api/otp/send`,          // duplicate safe\r\n    `${BACKEND_BASE}/auth/send-otp`,         // without /api\r\n    `${BACKEND_BASE}/otp/send`,\r\n    `${BACKEND_BASE}/otpRoutes/send`,\r\n  ];\r\n\r\n  // same list for verify (matching the send pattern)\r\n  const verifyCandidates = [\r\n    `${BACKEND_BASE}/api/auth/verify-otp`,\r\n    `${BACKEND_BASE}/api/otp/verify`,\r\n    `${BACKEND_BASE}/api/otpRoutes/verify`,\r\n    `${BACKEND_BASE}/auth/verify-otp`,\r\n    `${BACKEND_BASE}/otp/verify`,\r\n    `${BACKEND_BASE}/otpRoutes/verify`,\r\n  ];\r\n\r\n  function normalizePhoneInput(p) {\r\n    if (!p) return \"\";\r\n    const digits = String(p).replace(/\\D/g, \"\");\r\n    // prefer 10-digit (strip leading 91 or 0)\r\n    if (digits.length === 12 && digits.startsWith(\"91\")) return digits.slice(2);\r\n    if (digits.length === 11 && digits.startsWith(\"0\")) return digits.slice(1);\r\n    return digits;\r\n  }\r\n\r\n  async function tryPostUntilSuccess(urls, body) {\r\n    // Try each URL until one returns a JSON body with ok:true or an HTTP OK (200) with JSON\r\n    for (const u of urls) {\r\n      try {\r\n        console.debug(\"[AdminLogin] trying\", u, body);\r\n        setDebug(`Trying ${u}`);\r\n        const res = await fetch(u, {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(body),\r\n          credentials: \"include\",\r\n        });\r\n        // If server returned non-JSON, handle gracefully:\r\n        const text = await res.text();\r\n        let json;\r\n        try {\r\n          json = text ? JSON.parse(text) : {};\r\n        } catch (e) {\r\n          json = { ok: false, error: \"bad_json\", raw: text };\r\n        }\r\n\r\n        console.debug(\"[AdminLogin] response from\", u, res.status, json);\r\n        // Accept success if HTTP 200/201 and json.ok is true OR HTTP 200 and json is present\r\n        if ((res.status >= 200 && res.status < 300) && (json.ok === true || Object.keys(json).length > 0)) {\r\n          return { url: u, res, json };\r\n        } else {\r\n          // continue trying on 404/500 or json.ok false\r\n          continue;\r\n        }\r\n      } catch (err) {\r\n        console.warn(\"[AdminLogin] network error for\", u, err && err.message ? err.message : err);\r\n        continue;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  async function sendOtp() {\r\n    setMessage(\"\");\r\n    setDebug(\"\");\r\n    const normalized = normalizePhoneInput(phone);\r\n    if (!/^\\d{10}$/.test(normalized)) {\r\n      setMessage(\"Enter a valid 10-digit phone number (digits only).\");\r\n      return;\r\n    }\r\n    setLoading(true);\r\n    try {\r\n      const body = { phone: normalized }; // backend expects phone (or mobile) — many routes accept phone\r\n      const result = await tryPostUntilSuccess(endpointCandidates, body);\r\n\r\n      if (!result) {\r\n        setMessage(\"Failed to send OTP — no candidate endpoint responded (404/500). See console for details.\");\r\n        setDebug(\"Tried endpoints: \" + endpointCandidates.join(\", \"));\r\n        return;\r\n      }\r\n\r\n      // success (or at least server returned JSON)\r\n      console.info(\"[AdminLogin] OTP send succeeded at\", result.url, result.json);\r\n      setMessage(result.json && (result.json.message || result.json.error || \"OTP sent.\") );\r\n      setStage(\"verify\");\r\n      setDebug(`Used ${result.url}`);\r\n    } catch (err) {\r\n      console.error(\"[AdminLogin] sendOtp error:\", err);\r\n      setMessage(\"Network error sending OTP\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function verifyOtp() {\r\n    setMessage(\"\");\r\n    setDebug(\"\");\r\n    const normalized = normalizePhoneInput(phone);\r\n    if (!/^\\d{10}$/.test(normalized)) {\r\n      setMessage(\"Enter a valid phone first.\");\r\n      return;\r\n    }\r\n    if (!otp || !/^\\d{3,6}$/.test(String(otp).trim())) {\r\n      setMessage(\"Enter the OTP code.\");\r\n      return;\r\n    }\r\n    setLoading(true);\r\n    try {\r\n      const body = { phone: normalized, otp: String(otp).trim() };\r\n      const result = await tryPostUntilSuccess(verifyCandidates, body);\r\n      if (!result) {\r\n        setMessage(\"OTP verification failed — no endpoint accepted the request.\");\r\n        setDebug(\"Tried verify endpoints: \" + verifyCandidates.join(\", \"));\r\n        return;\r\n      }\r\n      console.info(\"[AdminLogin] verify succeeded at\", result.url, result.json);\r\n      if (result.json && result.json.ok) {\r\n        setMessage(\"Logged in — redirecting to admin...\");\r\n        setDebug(`Used ${result.url}`);\r\n        // give a short delay so user sees \"Logged in\" then redirect\r\n        setTimeout(() => (window.location.href = \"/admin/products\"), 400);\r\n      } else {\r\n        setMessage(result.json && (result.json.message || result.json.error) ? (result.json.message || result.json.error) : \"OTP verification failed\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"[AdminLogin] verifyOtp error:\", err);\r\n      setMessage(\"Network error verifying OTP\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div style={{ maxWidth: 720, margin: \"0 auto\", padding: 24 }}>\r\n      <h1>Admin Login</h1>\r\n\r\n      {message && <div style={{ color: \"red\", marginBottom: 12 }}>{message}</div>}\r\n\r\n      {stage === \"enter\" && (\r\n        <>\r\n          <label>Phone Number</label>\r\n          <input\r\n            value={phone}\r\n            onChange={(e) => setPhone(e.target.value)}\r\n            placeholder=\"10-digit phone (eg. 9042163246)\"\r\n            style={{ width: \"100%\", padding: 8, marginTop: 6 }}\r\n            disabled={loading}\r\n          />\r\n          <div style={{ marginTop: 10 }}>\r\n            <button onClick={sendOtp} disabled={loading}>\r\n              {loading ? \"Sending...\" : \"Send OTP\"}\r\n            </button>\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {stage === \"verify\" && (\r\n        <>\r\n          <label>OTP</label>\r\n          <input\r\n            value={otp}\r\n            onChange={(e) => setOtp(e.target.value)}\r\n            placeholder=\"Enter the OTP\"\r\n            style={{ width: \"100%\", padding: 8, marginTop: 6 }}\r\n            disabled={loading}\r\n          />\r\n          <div style={{ marginTop: 10 }}>\r\n            <button onClick={verifyOtp} disabled={loading}>\r\n              {loading ? \"Verifying...\" : \"Verify OTP\"}\r\n            </button>\r\n            <button onClick={() => { setStage(\"enter\"); setMessage(\"\"); setOtp(\"\"); }} style={{ marginLeft: 10 }}>\r\n              Change number\r\n            </button>\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      <div style={{ marginTop: 14, color: \"#666\", fontSize: 13 }}>\r\n        Debug: {debug || \"none\"} <br />\r\n        Backend base: {BACKEND_BASE}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","// src/admin/AdminProductList.js\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport axios from \"../api/axiosInstance\";\r\n\r\n/**\r\n * AdminProductList – CLEAN & FIXED VERSION\r\n * - DELETE now uses ONLY the correct endpoint: /api/products/:id\r\n * - No more retry on wrong routes (/api/admin/products/... etc)\r\n * - Product deletion will persist and NOT reappear\r\n */\r\n\r\nexport default function AdminProductList() {\r\n  const [products, setProducts] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [actionMsg, setActionMsg] = useState(\"\");\r\n  const navigate = useNavigate();\r\n\r\n  const BACKEND_FALLBACK_BASE = \"https://api.seemati.in/api\";\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n\r\n    async function fetchProducts() {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      const token =\r\n        localStorage.getItem(\"token\") ||\r\n        localStorage.getItem(\"authToken\") ||\r\n        null;\r\n\r\n      const headers = token ? { Authorization: `Bearer ${token}` } : {};\r\n\r\n      try {\r\n        const res = await axios.get(\"/api/products\", { headers });\r\n\r\n        const list =\r\n          Array.isArray(res.data?.products)\r\n            ? res.data.products\r\n            : Array.isArray(res.data)\r\n            ? res.data\r\n            : [];\r\n\r\n        if (!cancelled) {\r\n          setProducts(list);\r\n          setLoading(false);\r\n        }\r\n        return;\r\n      } catch (err) {\r\n        console.warn(\"Primary product load failed, trying fallback\", err);\r\n      }\r\n\r\n      // Fallback fetch\r\n      try {\r\n        const resp = await fetch(`${BACKEND_FALLBACK_BASE}/products`);\r\n        const json = await resp.json();\r\n        const list =\r\n          Array.isArray(json?.products)\r\n            ? json.products\r\n            : Array.isArray(json)\r\n            ? json\r\n            : [];\r\n\r\n        if (!cancelled) {\r\n          setProducts(list);\r\n          setLoading(false);\r\n        }\r\n      } catch (fbErr) {\r\n        if (!cancelled) {\r\n          setError(\"Unable to load products\");\r\n          setLoading(false);\r\n        }\r\n      }\r\n    }\r\n\r\n    fetchProducts();\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, []);\r\n\r\n  function pickThumbnail(p) {\r\n    if (!p) return null;\r\n    if (p.thumbnail) return p.thumbnail;\r\n    if (p.image) return p.image;\r\n    if (p.images && p.images.length) {\r\n      const first = p.images[0];\r\n      return typeof first === \"string\" ? first : first.url || null;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  function pickStock(p) {\r\n    return p?.stock ?? p?.qty ?? p?.inventory ?? p?.quantity ?? \"-\";\r\n  }\r\n\r\n  // ⭐ FIXED DELETE FUNCTION\r\n  async function handleDelete(id) {\r\n    const ok = window.confirm(\"Delete this product? This action cannot be undone.\");\r\n    if (!ok) return;\r\n\r\n    const prev = products;\r\n    setProducts(prev.filter((p) => (p._id || p.id) !== id));\r\n    setActionMsg(\"Deleting...\");\r\n\r\n    try {\r\n      const res = await axios.delete(`/api/products/${id}`);\r\n\r\n      if (!res.data?.success) {\r\n        throw new Error(res.data?.message || \"Delete failed\");\r\n      }\r\n\r\n      setActionMsg(\"Deleted\");\r\n      setTimeout(() => setActionMsg(\"\"), 1500);\r\n    } catch (err) {\r\n      console.error(\"Delete error\", err);\r\n      setProducts(prev);\r\n      setActionMsg(\"Delete failed: \" + (err.message || \"\"));\r\n      setTimeout(() => setActionMsg(\"\"), 2000);\r\n    }\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div style={{ padding: 20 }}>\r\n        <h2>Admin — Products</h2>\r\n        <p>Loading products…</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div style={{ padding: 20 }}>\r\n        <h2>Admin — Products</h2>\r\n        <div style={{ color: \"crimson\" }}>{error}</div>\r\n        <button onClick={() => window.location.reload()}>Retry</button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!products || products.length === 0) {\r\n    return (\r\n      <div style={{ padding: 20 }}>\r\n        <h2>Admin — Products</h2>\r\n        <p>No products found.</p>\r\n        <Link to=\"/admin/products/new\"><button>+ Add product</button></Link>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div style={{ padding: 20 }}>\r\n      <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\r\n        <h2>Admin — Products ({products.length})</h2>\r\n        <div style={{ display: \"flex\", gap: 8 }}>\r\n          <Link to=\"/admin/products/new\">\r\n            <button>+ Add product</button>\r\n          </Link>\r\n          <button onClick={() => window.location.reload()}>Refresh</button>\r\n        </div>\r\n      </div>\r\n\r\n      {actionMsg && <div style={{ marginTop: 12 }}>{actionMsg}</div>}\r\n\r\n      <div style={{ overflowX: \"auto\", marginTop: 16 }}>\r\n        <table style={{ width: \"100%\", borderCollapse: \"collapse\", minWidth: 900 }}>\r\n          <thead>\r\n            <tr style={{ borderBottom: \"2px solid #eee\", textAlign: \"left\" }}>\r\n              <th>#</th>\r\n              <th>SKU</th>\r\n              <th>Thumbnail</th>\r\n              <th>Name / Slug</th>\r\n              <th>Category</th>\r\n              <th>Price</th>\r\n              <th>Stock</th>\r\n              <th>Actions</th>\r\n            </tr>\r\n          </thead>\r\n\r\n          <tbody>\r\n            {products.map((p, idx) => {\r\n              const id = p._id || p.id || p.slug;\r\n              const thumb = pickThumbnail(p);\r\n\r\n              return (\r\n                <tr key={id} style={{ borderBottom: \"1px solid #eee\" }}>\r\n                  <td>{idx + 1}</td>\r\n                  <td>{p.sku || \"-\"}</td>\r\n                  <td>\r\n                    {thumb ? (\r\n                      <img src={thumb} style={{ width: 64, height: 64, borderRadius: 4, objectFit: \"cover\" }} />\r\n                    ) : (\r\n                      <div style={{ width: 64, height: 64, background: \"#eee\", borderRadius: 4 }} />\r\n                    )}\r\n                  </td>\r\n                  <td>\r\n                    <div style={{ fontWeight: 700 }}>{p.title}</div>\r\n                    <div>{p.slug}</div>\r\n                  </td>\r\n                  <td>{p.category || \"-\"}</td>\r\n                  <td>{p.price ?? \"-\"}</td>\r\n                  <td>{pickStock(p)}</td>\r\n                  <td>\r\n                    <div style={{ display: \"flex\", gap: 8 }}>\r\n                      <Link to={`/admin/products/${id}`}>\r\n                        <button>Edit</button>\r\n                      </Link>\r\n\r\n                      <button onClick={() => handleDelete(id)}>Delete</button>\r\n\r\n                      <button\r\n                        onClick={() => window.open(`/product/${p.slug}`, \"_blank\")}\r\n                      >\r\n                        Preview\r\n                      </button>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","// src/admin/AdminProductEdit.js\r\nimport React, { useEffect, useState, useRef } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport axiosInstance from '../api/axiosInstance';\r\n\r\n/*\r\n Full replacement preserving your features:\r\n - color picker, video preview, auto-slug, auto-sku, images upload, keepMap, etc.\r\n - Adds fallback for GET product\r\n - On upload, tries multiple candidate endpoints (PUT/POST) until one accepts the files\r\n - On save, tries multiple candidate update endpoints until one succeeds\r\n*/\r\n\r\nconst NAMED_COLORS = {\r\n  white: '#FFFFFF', silver: '#C0C0C0', gray: '#808080', black: '#000000',\r\n  red: '#FF0000', maroon: '#800000', yellow: '#FFFF00', olive: '#808000',\r\n  lime: '#00FF00', green: '#008000', aqua: '#00FFFF', teal: '#008080',\r\n  blue: '#0000FF', navy: '#000080', fuchsia: '#FF00FF', purple: '#800080',\r\n  pink: '#FFC0CB', brown: '#A52A2A', orange: '#FFA500', gold: '#FFD700',\r\n  peach: '#FFDAB9', mustard: '#FFDB58', coral: '#FF7F50'\r\n};\r\n\r\nfunction hexToRgb(hex) {\r\n  if (!hex) return { r: 0, g: 0, b: 0 };\r\n  const clean = hex.replace('#', '').trim();\r\n  if (clean.length === 3) {\r\n    return {\r\n      r: parseInt(clean[0] + clean[0], 16),\r\n      g: parseInt(clean[1] + clean[1], 16),\r\n      b: parseInt(clean[2] + clean[2], 16)\r\n    };\r\n  }\r\n  return {\r\n    r: parseInt(clean.substring(0, 2), 16),\r\n    g: parseInt(clean.substring(2, 4), 16),\r\n    b: parseInt(clean.substring(4, 6), 16)\r\n  };\r\n}\r\nfunction nearestColorName(hex) {\r\n  try {\r\n    const src = hexToRgb(hex);\r\n    let best = null;\r\n    let bestDist = Infinity;\r\n    Object.entries(NAMED_COLORS).forEach(([name, h]) => {\r\n      const t = hexToRgb(h);\r\n      const dx = src.r - t.r, dy = src.g - t.g, dz = src.b - t.b;\r\n      const dist = dx * dx + dy * dy + dz * dz;\r\n      if (dist < bestDist) { bestDist = dist; best = name; }\r\n    });\r\n    return best || '';\r\n  } catch { return ''; }\r\n}\r\n\r\nfunction makeSlug(text) {\r\n  if (!text) return \"\";\r\n  return String(text)\r\n    .toLowerCase()\r\n    .trim()\r\n    .replace(/['\"]/g, \"\")\r\n    .replace(/[^a-z0-9]+/g, \"-\")\r\n    .replace(/^-+|-+$/g, \"\")\r\n    .replace(/-+/g, \"-\");\r\n}\r\n\r\nfunction sanitizeAlnum(s = \"\") {\r\n  return String(s || \"\").replace(/[^a-z0-9]/gi, \"\").toUpperCase();\r\n}\r\nfunction generateSku({ brand, category, title }) {\r\n  const b = sanitizeAlnum(brand || \"\");\r\n  const c = sanitizeAlnum(category || \"\");\r\n  let prefix = \"KPL\";\r\n  if (b && c) {\r\n    const pb = b.slice(0, 3);\r\n    const pc = c.slice(0, 3);\r\n    prefix = `${pb}-${pc}`;\r\n  } else if (b) {\r\n    prefix = `${b.slice(0, 3)}`;\r\n  } else if (c) {\r\n    prefix = `${c.slice(0, 3)}`;\r\n  } else if (title) {\r\n    prefix = sanitizeAlnum(title).slice(0, 3) || \"KPL\";\r\n  }\r\n  const counter = String(Math.abs(Date.now()) % 1000).padStart(3, \"0\");\r\n  return `${prefix}-${counter}`;\r\n}\r\n\r\nexport default function AdminProductEdit() {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const fileInputRef = useRef(null);\r\n  const colorPickerRef = useRef(null);\r\n  const [colorPickerIndex, setColorPickerIndex] = useState(null);\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [product, setProduct] = useState({\r\n    title: '', slug: '', price: '', mrp: '', stock: '', sku: '',\r\n    brand: '', category: '', videoUrl: '', colors: '', sizes: '',\r\n    description: '', isPublished: false\r\n  });\r\n\r\n  const [slugEdited, setSlugEdited] = useState(false);\r\n  const [skuEdited, setSkuEdited] = useState(false);\r\n\r\n  const [existingImages, setExistingImages] = useState([]);\r\n  const [keepMap, setKeepMap] = useState({});\r\n  const [selectedFiles, setSelectedFiles] = useState([]);\r\n  const [swatches, setSwatches] = useState([]);\r\n\r\n  const parseColorsInputToArray = (text) => {\r\n    if (!text) return [];\r\n    return text.split(',').map(s => s.trim()).filter(Boolean);\r\n  };\r\n  const normalizeToHexIfPossible = (col) => {\r\n    if (!col) return '';\r\n    const t = col.trim();\r\n    if (/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/.test(t)) {\r\n      const clean = t.replace('#', '');\r\n      const full = clean.length === 3 ? clean[0]+clean[0]+clean[1]+clean[1]+clean[2]+clean[2] : clean;\r\n      return `#${full.toUpperCase()}`;\r\n    }\r\n    const lower = t.toLowerCase();\r\n    if (NAMED_COLORS[lower]) return NAMED_COLORS[lower].toUpperCase();\r\n    return t;\r\n  };\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    if (!id) {\r\n      setLoading(false);\r\n      setExistingImages([]);\r\n      setKeepMap({});\r\n      setSwatches([]);\r\n      setProduct(prev => {\r\n        const seeded = { ...prev };\r\n        if (!seeded.slug && seeded.title) seeded.slug = makeSlug(seeded.title);\r\n        if (!seeded.sku) seeded.sku = generateSku({ brand: seeded.brand, category: seeded.category, title: seeded.title });\r\n        return seeded;\r\n      });\r\n      return () => { cancelled = true; };\r\n    }\r\n\r\n    async function load() {\r\n      try {\r\n        setLoading(true);\r\n        try {\r\n          const resp = await axiosInstance.get(`/api/products/${id}`);\r\n          if (resp && resp.data) {\r\n            const p = resp.data.product || (resp.data.success && resp.data.products && resp.data.products[0]) || resp.data;\r\n            if (p && typeof p === 'object') {\r\n              populateFromProduct(p);\r\n              setLoading(false);\r\n              return;\r\n            }\r\n          }\r\n        } catch (err) {\r\n          console.warn('Direct GET failed, falling back to list', err && err.response ? err.response.status : err.message);\r\n        }\r\n\r\n        try {\r\n          const listResp = await axiosInstance.get('/api/products');\r\n          const products = (listResp && listResp.data && (listResp.data.products || listResp.data)) || [];\r\n          if (Array.isArray(products) && products.length) {\r\n            let found = products.find(p => String(p._id) === String(id));\r\n            if (!found) found = products.find(p => p.slug === id || String(p.slug) === String(id));\r\n            if (found) { populateFromProduct(found); setLoading(false); return; }\r\n          }\r\n          alert('Product not found on server.');\r\n        } catch (err) {\r\n          console.error('Products list fallback failed', err);\r\n          alert('Failed to load product list fallback. See console.');\r\n        }\r\n      } finally {\r\n        if (!cancelled) setLoading(false);\r\n      }\r\n    }\r\n\r\n    function populateFromProduct(p) {\r\n      setProduct({\r\n        title: p.title || '', slug: p.slug || '', price: p.price || '', mrp: p.mrp || '',\r\n        stock: p.stock || '', sku: p.sku || '', brand: p.brand || '', category: p.category || '',\r\n        videoUrl: p.videoUrl || '', colors: Array.isArray(p.colors) ? p.colors.join(', ') : (p.colors || ''),\r\n        sizes: Array.isArray(p.sizes) ? p.sizes.join(', ') : (p.sizes || ''), description: p.description || '',\r\n        isPublished: !!p.isPublished\r\n      });\r\n      if (p.slug) setSlugEdited(true);\r\n      if (p.sku) setSkuEdited(true);\r\n      const imgs = Array.isArray(p.images) ? p.images.map(it => (typeof it === 'string' ? it : (it.url || it))) : [];\r\n      setExistingImages(imgs);\r\n      const map = {}; imgs.forEach(url => (map[url] = true)); setKeepMap(map);\r\n      const parsed = Array.isArray(p.colors) ? p.colors : (p.colors ? p.colors.split(',').map(s => s.trim()) : []);\r\n      const normalized = parsed.map((c) => normalizeToHexIfPossible(c));\r\n      setSwatches(normalized);\r\n    }\r\n\r\n    load();\r\n    return () => { cancelled = true; selectedFiles.forEach(s => s.previewUrl && URL.revokeObjectURL(s.previewUrl)); };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [id]);\r\n\r\n  useEffect(() => {\r\n    const mapped = swatches.map((s) => {\r\n      if (!s) return '';\r\n      const found = Object.entries(NAMED_COLORS).find(([, v]) => v.toUpperCase() === s.toUpperCase());\r\n      if (found) return found[0].toUpperCase();\r\n      return s;\r\n    }).filter(Boolean).join(', ');\r\n    setProduct(prev => ({ ...prev, colors: mapped }));\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [swatches]);\r\n\r\n  useEffect(() => {\r\n    if (!slugEdited) {\r\n      setProduct(prev => ({ ...prev, slug: makeSlug(prev.title || \"\") }));\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [product.title, slugEdited]);\r\n\r\n  useEffect(() => {\r\n    if (!skuEdited) {\r\n      const s = generateSku({ brand: product.brand, category: product.category, title: product.title });\r\n      setProduct(prev => ({ ...prev, sku: s }));\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [product.brand, product.category, product.title, skuEdited]);\r\n\r\n  function handleChange(e) {\r\n    const { name, value, checked } = e.target;\r\n    if (name === 'isPublished') setProduct(prev => ({ ...prev, isPublished: !!checked }));\r\n    else {\r\n      if (name === 'slug') setSlugEdited(true);\r\n      if (name === 'sku') setSkuEdited(true);\r\n      setProduct(prev => ({ ...prev, [name]: value }));\r\n      if (name === 'colors') {\r\n        const arr = parseColorsInputToArray(value).map(c => normalizeToHexIfPossible(c));\r\n        setSwatches(arr);\r\n      }\r\n    }\r\n  }\r\n\r\n  function onFilesSelected(e) {\r\n    const files = Array.from(e.target.files || []);\r\n    if (!files.length) return;\r\n    const newSelected = files.map(f => ({ file: f, previewUrl: URL.createObjectURL(f) }));\r\n    setSelectedFiles(prev => [...prev, ...newSelected]);\r\n    if (fileInputRef.current) fileInputRef.current.value = '';\r\n  }\r\n  function removeSelectedPreview(index) {\r\n    setSelectedFiles(prev => {\r\n      const copy = [...prev];\r\n      const removed = copy.splice(index, 1)[0];\r\n      if (removed && removed.previewUrl) URL.revokeObjectURL(removed.previewUrl);\r\n      return copy;\r\n    });\r\n  }\r\n  function toggleKeep(url) { setKeepMap(prev => ({ ...prev, [url]: !prev[url] })); }\r\n\r\n  function handleGenerateSku() {\r\n    const newSku = generateSku({ brand: product.brand, category: product.category, title: product.title });\r\n    setProduct(prev => ({ ...prev, sku: newSku }));\r\n    setSkuEdited(true);\r\n  }\r\n\r\n  // --- Robust uploadFilesToProduct: tries multiple candidate endpoints for uploading files ---\r\n   // --- Upload files for this product: always hit the S3-enabled upload route ---\r\n   // --- Robust uploadFilesToProduct: tries multiple candidate endpoints for uploading files ---\r\n  async function uploadFilesToProduct(pId) {\r\n  if (!selectedFiles.length) return [];\r\n  if (!pId) throw new Error(\"Missing product id for upload\");\r\n\r\n  const formData = new FormData();\r\n  selectedFiles.forEach(s => formData.append(\"images\", s.file));\r\n\r\n  // ---- FINAL, CORRECT ENDPOINTS ----\r\n  const candidates = [\r\n  // Existing product\r\n  { method: \"put\", url: `/api/uploadRoutes/${pId}/upload` },\r\n\r\n  // New product\r\n  { method: \"post\", url: `/api/uploadRoutes/upload` }\r\n];\r\n\r\n\r\n  let lastErr = null;\r\n\r\n  for (const c of candidates) {\r\n    try {\r\n      let resp;\r\n      if (c.method === \"put\") {\r\n        resp = await axiosInstance.put(c.url, formData, {\r\n          headers: { \"Content-Type\": \"multipart/form-data\" }\r\n        });\r\n      } else {\r\n        resp = await axiosInstance.post(c.url, formData, {\r\n          headers: { \"Content-Type\": \"multipart/form-data\" }\r\n        });\r\n      }\r\n\r\n      const data = resp.data || {};\r\n      const array =\r\n        (Array.isArray(data.uploaded) && data.uploaded) ||\r\n        (data.url ? [{ url: data.url }] : []);\r\n\r\n      return array.map(f => f.url);\r\n    } catch (err) {\r\n      lastErr = err;\r\n      console.warn(`UPLOAD FAIL @ ${c.url}`, err?.response?.status);\r\n    }\r\n  }\r\n\r\n  throw new Error(\r\n    lastErr?.response?.data?.error ||\r\n      lastErr?.message ||\r\n      \"Upload failed\"\r\n  );\r\n}\r\n\r\n\r\n  async function createMinimalProduct(body) {\r\n    const payload = {\r\n      title: body.title || 'Untitled product',\r\n      slug: body.slug || '',\r\n      price: Number(body.price) || 0,\r\n      mrp: Number(body.mrp) || 0,\r\n      stock: Number(body.stock) || 0,\r\n      sku: body.sku || '',\r\n      brand: body.brand || '',\r\n      category: body.category || '',\r\n      videoUrl: body.videoUrl || '',\r\n      description: body.description || '',\r\n      isPublished: !!body.isPublished,\r\n      colors: body.colors || [],\r\n      sizes: body.sizes || [],\r\n      images: []\r\n    };\r\n    const res = await axiosInstance.post('/api/products', payload);\r\n    const created = res && res.data ? (res.data.product || res.data) : null;\r\n    if (!created) throw new Error('Create product failed: no product returned');\r\n    return created;\r\n  }\r\n\r\n  async function handleSave(e) {\r\n    e.preventDefault();\r\n    setSaving(true);\r\n\r\n    try {\r\n      const bodyForProduct = {\r\n        title: product.title,\r\n        slug: product.slug,\r\n        price: Number(product.price) || 0,\r\n        mrp: Number(product.mrp) || 0,\r\n        stock: Number(product.stock) || 0,\r\n        sku: product.sku,\r\n        brand: product.brand,\r\n        category: product.category,\r\n        videoUrl: product.videoUrl,\r\n        description: product.description,\r\n        isPublished: !!product.isPublished,\r\n        colors: swatches.map(s => s),\r\n        sizes: product.sizes ? product.sizes.split(',').map(s => s.trim()).filter(Boolean) : []\r\n      };\r\n\r\n      let targetId = id;\r\n\r\n      if (!targetId) {\r\n        if (!bodyForProduct.slug) bodyForProduct.slug = makeSlug(bodyForProduct.title || \"\");\r\n        if (!bodyForProduct.sku) bodyForProduct.sku = generateSku({ brand: bodyForProduct.brand, category: bodyForProduct.category, title: bodyForProduct.title });\r\n        const created = await createMinimalProduct(bodyForProduct);\r\n        targetId = created._id || created.id || (created._id && created._id.toString());\r\n        if (!targetId) throw new Error('Could not obtain new product id from create response');\r\n        setProduct(prev => ({ ...prev, slug: created.slug || prev.slug, sku: created.sku || prev.sku }));\r\n      }\r\n\r\n      // Try upload first if files selected\r\n      let uploadedUrls = [];\r\n      if (selectedFiles.length) {\r\n        try {\r\n          uploadedUrls = await uploadFilesToProduct(targetId);\r\n        } catch (err) {\r\n          console.error('Upload request failed', err);\r\n          throw new Error('Upload request failed: ' + (err.message || err));\r\n        }\r\n      }\r\n\r\n      const kept = existingImages.filter(u => keepMap[u]);\r\n      const finalImages = [...kept];\r\n      uploadedUrls.forEach(u => { if (!finalImages.includes(u)) finalImages.push(u); });\r\n\r\n      const finalBody = { ...bodyForProduct, images: finalImages };\r\n\r\n      const triedUrls = [\r\n        { url: `/api/products/${targetId}`, desc: 'public' },\r\n        { url: `/api/admin/product/${targetId}`, desc: 'admin (api/admin/product)' },\r\n        { url: `/api/admin/products/${targetId}`, desc: 'admin (api/admin/products)' },\r\n        { url: `/api/adminProduct/products/${targetId}`, desc: 'adminProduct (api/adminProduct/products)' }\r\n      ];\r\n\r\n      let savedResp = null;\r\n      let lastErr = null;\r\n      for (const t of triedUrls) {\r\n        try {\r\n          const resp = await axiosInstance.put(t.url, finalBody);\r\n          if (resp && resp.status >= 200 && resp.status < 300) {\r\n            savedResp = resp;\r\n            break;\r\n          }\r\n        } catch (err) {\r\n          lastErr = err;\r\n          console.warn(`[save] PUT ${t.url} failed`, err && err.response && err.response.status ? err.response.status : err.message);\r\n        }\r\n      }\r\n\r\n      if (!savedResp) {\r\n        console.error('All update attempts failed', lastErr);\r\n        const msg = lastErr && lastErr.response && lastErr.response.data && lastErr.response.data.message\r\n          ? lastErr.response.data.message\r\n          : (lastErr && lastErr.message) || 'Save failed on all attempted update endpoints';\r\n        throw new Error(msg);\r\n      }\r\n\r\n      selectedFiles.forEach(s => s.previewUrl && URL.revokeObjectURL(s.previewUrl));\r\n      setSelectedFiles([]);\r\n      const updatedProduct = savedResp.data.product || savedResp.data;\r\n      const imgs = Array.isArray(updatedProduct.images) ? updatedProduct.images.map(it => (typeof it === 'string' ? it : (it.url || it))) : [];\r\n      setExistingImages(imgs);\r\n      const map = {}; imgs.forEach(u => (map[u] = true)); setKeepMap(map);\r\n      alert(!id ? 'Product created and saved.' : 'Product updated.');\r\n      if (!id && targetId) navigate(`/admin/products/${targetId}/edit`);\r\n    } catch (err) {\r\n      console.error('Save error', err);\r\n      const msg = (err && err.response && err.response.data && (err.response.data.message || JSON.stringify(err.response.data))) || (err && err.message) || 'Save failed';\r\n      alert(msg);\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  }\r\n\r\n  function openColorPickerAtIndex(idx) {\r\n    setColorPickerIndex(idx);\r\n    if (colorPickerRef.current) {\r\n      const cur = swatches[idx] || '#FFFFFF';\r\n      const normalized = normalizeToHexIfPossible(cur) || '#FFFFFF';\r\n      colorPickerRef.current.value = normalized;\r\n      colorPickerRef.current.click();\r\n    }\r\n  }\r\n  function onColorPickerChange(e) {\r\n    const val = e.target.value;\r\n    const idx = colorPickerIndex;\r\n    setColorPickerIndex(null);\r\n    if (idx == null) return;\r\n    setSwatches(prev => { const copy = [...prev]; copy[idx] = val.toUpperCase(); return copy; });\r\n  }\r\n  function addSwatch() { setSwatches(prev => [...prev, '#FFFFFF']); }\r\n  function removeSwatch(i) { setSwatches(prev => prev.filter((_, idx) => idx !== i)); }\r\n\r\n  function getYouTubeEmbedUrl(raw) {\r\n    if (!raw) return null;\r\n    try {\r\n      const u = raw.trim();\r\n      const vMatch = u.match(/[?&]v=([^&]+)/);\r\n      if (vMatch) return `https://www.youtube.com/embed/${vMatch[1]}`;\r\n      const short = u.match(/youtu\\.be\\/([^?&]+)/);\r\n      if (short) return `https://www.youtube.com/embed/${short[1]}`;\r\n      if (u.includes('youtube.com/embed/')) return u;\r\n      return null;\r\n    } catch { return null; }\r\n  }\r\n\r\n  if (loading) return <div>Loading...</div>;\r\n\r\n  return (\r\n    <div style={{ display: 'flex', gap: 40, padding: 12 }}>\r\n      <form onSubmit={handleSave} style={{ width: '40%' }}>\r\n        <div style={{ marginBottom: 10 }}>\r\n          <button type=\"button\" onClick={() => navigate('/admin/products')}>Back to products</button>\r\n        </div>\r\n\r\n        <div><label>Title</label><br />\r\n          <input name=\"title\" value={product.title} onChange={handleChange} style={{ width: '100%' }} /></div>\r\n\r\n        <div><label>Slug</label><br />\r\n          <input\r\n            name=\"slug\"\r\n            value={product.slug}\r\n            onChange={(e) => { handleChange(e); setSlugEdited(true); }}\r\n            style={{ width: '100%' }} /></div>\r\n\r\n        <div><label>Price</label><br />\r\n          <input name=\"price\" value={product.price} onChange={handleChange} style={{ width: '100%' }} /></div>\r\n\r\n        <div><label>MRP</label><br />\r\n          <input name=\"mrp\" value={product.mrp} onChange={handleChange} style={{ width: '100%' }} /></div>\r\n\r\n        <div><label>Stock</label><br />\r\n          <input name=\"stock\" value={product.stock} onChange={handleChange} style={{ width: '100%' }} /></div>\r\n\r\n        <div><label>SKU</label><br />\r\n          <div style={{ display: 'flex', gap: 8, alignItems: 'center' }}>\r\n            <input\r\n              name=\"sku\"\r\n              value={product.sku}\r\n              onChange={(e) => { handleChange(e); setSkuEdited(true); }}\r\n              style={{ width: '100%' }} />\r\n            <button type=\"button\" onClick={handleGenerateSku}>Generate SKU</button>\r\n          </div>\r\n          <div style={{ fontSize: 12, color: '#555', marginTop: 6 }}>\r\n            Format: BRAND-CTG-XXX or fallback KPL-XXX (XXX = 3-digit counter)\r\n          </div>\r\n        </div>\r\n\r\n        <div><label>Brand</label><br />\r\n          <input name=\"brand\" value={product.brand} onChange={handleChange} style={{ width: '100%' }} /></div>\r\n\r\n        <div><label>Category</label><br />\r\n          <input name=\"category\" value={product.category} onChange={handleChange} style={{ width: '100%' }} /></div>\r\n\r\n        <div><label>Video URL (YouTube)</label><br />\r\n          <input name=\"videoUrl\" value={product.videoUrl} onChange={handleChange} style={{ width: '100%' }} />\r\n          <div style={{ fontSize: 12, marginTop: 6, color: '#555' }}>\r\n            Paste YouTube link (example: https://youtu.be/VIDEOID or https://www.youtube.com/watch?v=VIDEOID)\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ marginTop: 12 }}>\r\n          <label>Colors (comma-separated)</label><br />\r\n          <input name=\"colors\" value={product.colors} onChange={handleChange} style={{ width: '100%' }} />\r\n          <div style={{ display: 'flex', gap: 12, flexWrap: 'wrap', marginTop: 10, alignItems: 'center' }}>\r\n            {swatches.map((c, i) => {\r\n              const isHex = /^#([0-9A-F]{6})$/i.test(String(c).trim());\r\n              const bg = isHex ? c : '#EEE';\r\n              const suggestedName = isHex ? nearestColorName(c) : (String(c) || '');\r\n              return (\r\n                <div key={i} style={{ textAlign: 'center' }}>\r\n                  <div title={String(c)} onClick={() => openColorPickerAtIndex(i)}\r\n                    style={{ width: 48, height: 48, borderRadius: 6, border: '1px solid #ccc', boxShadow: '0 1px 6px rgba(0,0,0,0.12)', background: bg, cursor: 'pointer' }} />\r\n                  <div style={{ fontSize: 12, marginTop: 6, maxWidth: 80, wordBreak: 'break-word' }}>{suggestedName || String(c).slice(0, 12)}</div>\r\n                  <div style={{ marginTop: 6 }}><button type=\"button\" onClick={() => removeSwatch(i)}>Remove</button></div>\r\n                </div>\r\n              );\r\n            })}\r\n            <div><button type=\"button\" onClick={addSwatch}>+ Add color</button></div>\r\n            <input ref={colorPickerRef} type=\"color\" style={{ display: 'none' }} onChange={onColorPickerChange} aria-hidden=\"true\" />\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ marginTop: 12 }}>\r\n          <label>Sizes (comma-separated)</label><br />\r\n          <input name=\"sizes\" value={product.sizes} onChange={handleChange} style={{ width: '100%' }} />\r\n        </div>\r\n\r\n        <div><label>Description</label><br />\r\n          <textarea name=\"description\" value={product.description} onChange={handleChange} rows={6} style={{ width: '100%' }} /></div>\r\n\r\n        <div>\r\n          <label><input name=\"isPublished\" type=\"checkbox\" checked={product.isPublished} onChange={handleChange} /> Published</label>\r\n        </div>\r\n\r\n        <div style={{ marginTop: 8 }}>\r\n          <button type=\"submit\" disabled={saving}>{saving ? 'Saving...' : (!id ? 'Create product' : 'Save')}</button>\r\n          <button type=\"button\" onClick={() => navigate('/admin/products')}>Cancel</button>\r\n        </div>\r\n      </form>\r\n\r\n      <div style={{ width: '50%' }}>\r\n        <h3>Existing Images</h3>\r\n        <div style={{ display: 'flex', gap: 12, flexWrap: 'wrap' }}>\r\n          {existingImages.map((url, idx) => (\r\n            <div key={url} style={{ textAlign: 'center', width: 120 }}>\r\n              <img src={url} alt={`img-${idx}`} style={{ width: 100, height: 100, objectFit: 'cover' }} />\r\n              <div><label><input type=\"checkbox\" checked={!!keepMap[url]} onChange={() => toggleKeep(url)} /> Keep</label></div>\r\n              <div><button type=\"button\" onClick={() => { setKeepMap(prev => ({ ...prev, [url]: false })); }}>Remove</button></div>\r\n            </div>\r\n          ))}\r\n          {existingImages.length === 0 && <div>No existing images</div>}\r\n        </div>\r\n\r\n        <h3 style={{ marginTop: 16 }}>Add Images</h3>\r\n        <input ref={fileInputRef} type=\"file\" multiple onChange={onFilesSelected} />\r\n        <div style={{ marginTop: 8, display: 'flex', gap: 12, flexWrap: 'wrap' }}>\r\n          {selectedFiles.map((s, i) => (\r\n            <div key={s.previewUrl + i} style={{ textAlign: 'center', width: 120 }}>\r\n              <img src={s.previewUrl} alt={`preview-${i}`} style={{ width: 100, height: 100, objectFit: 'cover' }} />\r\n              <div><button type=\"button\" onClick={() => removeSelectedPreview(i)}>Remove</button></div>\r\n            </div>\r\n          ))}\r\n          {selectedFiles.length === 0 && <div>No files chosen</div>}\r\n        </div>\r\n\r\n        <div style={{ marginTop: 20 }}>\r\n          <h4>Video preview</h4>\r\n          {product.videoUrl ? (() => {\r\n            const embed = getYouTubeEmbedUrl(product.videoUrl);\r\n            if (embed) {\r\n              return <div style={{ width: '100%', height: 250 }}><iframe title=\"video-preview\" src={embed} style={{ width: '100%', height: '100%', border: 'none' }} allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowFullScreen /></div>;\r\n            }\r\n            return <div>Unsupported video URL (currently only YouTube links are previewed).</div>;\r\n          })() : (<div>No video URL provided</div>)}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","// src/admin/AddProduct.jsx\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport axiosInstance from \"../api/axiosInstance\";\r\n\r\n/**\r\n * AddProduct: admin \"create product\" form\r\n * - color swatches with native color picker (click a swatch to open)\r\n * - colors input kept in sync with swatches\r\n * - previews for selected files and upload to backend\r\n * - video preview (YouTube)\r\n *\r\n * Auto behavior:\r\n * - auto-slug generated from title (kebab-case) unless slug manually edited\r\n * - auto-sku generated from brand+category (or fallback KPL) unless sku manually edited\r\n * - \"Generate SKU\" button added next to SKU field\r\n */\r\n\r\n// Named color map for suggestions (same-ish list as edit page)\r\nconst NAMED_COLORS = {\r\n  white: \"#FFFFFF\",\r\n  silver: \"#C0C0C0\",\r\n  gray: \"#808080\",\r\n  black: \"#000000\",\r\n  red: \"#FF0000\",\r\n  maroon: \"#800000\",\r\n  yellow: \"#FFFF00\",\r\n  olive: \"#808000\",\r\n  lime: \"#00FF00\",\r\n  green: \"#008000\",\r\n  aqua: \"#00FFFF\",\r\n  teal: \"#008080\",\r\n  blue: \"#0000FF\",\r\n  navy: \"#000080\",\r\n  fuchsia: \"#FF00FF\",\r\n  purple: \"#800080\",\r\n  pink: \"#FFC0CB\",\r\n  brown: \"#A52A2A\",\r\n  orange: \"#FFA500\",\r\n  gold: \"#FFD700\",\r\n  peach: \"#FFDAB9\",\r\n  mustard: \"#FFDB58\",\r\n  coral: \"#FF7F50\",\r\n  // brand custom examples\r\n  \"#1026CB\": \"blue\",\r\n  \"#1A84C7\": \"teal\",\r\n  \"#E40C0C\": \"red\",\r\n  \"#010913\": \"black\",\r\n  \"#584141\": \"brown\"\r\n};\r\n\r\n// Helpers\r\nfunction hexToRgb(hex) {\r\n  if (!hex) return null;\r\n  const h = hex.replace(\"#\", \"\").trim();\r\n  const full = h.length === 3 ? h.split(\"\").map(c => c + c).join(\"\") : h;\r\n  if (full.length !== 6) return null;\r\n  return {\r\n    r: parseInt(full.slice(0, 2), 16),\r\n    g: parseInt(full.slice(2, 4), 16),\r\n    b: parseInt(full.slice(4, 6), 16),\r\n  };\r\n}\r\nfunction normalizeToHexIfPossible(col) {\r\n  if (!col) return \"\";\r\n  const t = String(col).trim();\r\n  // hex like #abc or #aabbcc\r\n  if (/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/.test(t)) {\r\n    const clean = t.replace(\"#\", \"\");\r\n    const full = clean.length === 3 ? clean.split(\"\").map(c => c + c).join(\"\") : clean;\r\n    return `#${full.toUpperCase()}`;\r\n  }\r\n  const lower = t.toLowerCase();\r\n  if (NAMED_COLORS[lower]) return NAMED_COLORS[lower].toUpperCase();\r\n  // if user passed hex without # like \"abc123\"\r\n  if (/^[0-9A-Fa-f]{6}$/.test(t)) return `#${t.toUpperCase()}`;\r\n  // fallback: return original string (label)\r\n  return t;\r\n}\r\nfunction nearestColorName(hex) {\r\n  try {\r\n    const target = hexToRgb(hex);\r\n    if (!target) return hex;\r\n    let best = null;\r\n    let bestDist = Infinity;\r\n    for (const [name, val] of Object.entries(NAMED_COLORS)) {\r\n      const h = normalizeToHexIfPossible(val);\r\n      const rgb = hexToRgb(h);\r\n      if (!rgb) continue;\r\n      const d = (rgb.r - target.r) ** 2 + (rgb.g - target.g) ** 2 + (rgb.b - target.b) ** 2;\r\n      if (d < bestDist) {\r\n        bestDist = d;\r\n        best = name;\r\n      }\r\n    }\r\n    if (!best) return hex;\r\n    if (bestDist > 160 * 160) return hex; // too far -> return hex\r\n    return best;\r\n  } catch {\r\n    return hex;\r\n  }\r\n}\r\n\r\nfunction getYouTubeEmbedUrl(raw) {\r\n  if (!raw || typeof raw !== \"string\") return null;\r\n  const s = raw.trim();\r\n  try {\r\n    const url = new URL(s, window.location.origin);\r\n    const host = url.hostname.toLowerCase();\r\n    if (host.includes(\"youtube.com\")) {\r\n      if (url.pathname.startsWith(\"/embed/\")) return `https://www.youtube.com${url.pathname}${url.search || \"\"}`;\r\n      const vid = url.searchParams.get(\"v\");\r\n      if (vid) return `https://www.youtube.com/embed/${vid}`;\r\n    }\r\n    if (host.includes(\"youtu.be\")) {\r\n      const vid = url.pathname.replace(\"/\", \"\");\r\n      if (vid) return `https://www.youtube.com/embed/${vid}`;\r\n    }\r\n  } catch (err) {\r\n    const maybeId = s.match(/^[A-Za-z0-9_-]{8,}$/);\r\n    if (maybeId) return `https://www.youtube.com/embed/${maybeId[0]}`;\r\n  }\r\n  return null;\r\n}\r\n\r\n// slug helper\r\nfunction makeSlug(text) {\r\n  if (!text) return \"\";\r\n  return String(text)\r\n    .toLowerCase()\r\n    .trim()\r\n    .replace(/['\"]/g, \"\") // remove quotes\r\n    .replace(/[^a-z0-9]+/g, \"-\")\r\n    .replace(/^-+|-+$/g, \"\")\r\n    .replace(/-+/g, \"-\");\r\n}\r\n\r\n// sku helper\r\nfunction sanitizeAlnum(s = \"\") {\r\n  return String(s || \"\").replace(/[^a-z0-9]/gi, \"\").toUpperCase();\r\n}\r\nfunction generateSku({ brand, category, title }) {\r\n  const b = sanitizeAlnum(brand || \"\");\r\n  const c = sanitizeAlnum(category || \"\");\r\n  let prefix = \"KPL\"; // fallback prefix\r\n  if (b && c) {\r\n    const pb = b.slice(0, 3);\r\n    const pc = c.slice(0, 3);\r\n    prefix = `${pb}-${pc}`;\r\n  } else if (b) {\r\n    prefix = `${b.slice(0, 3)}`;\r\n  } else if (c) {\r\n    prefix = `${c.slice(0, 3)}`;\r\n  } else if (title) {\r\n    prefix = sanitizeAlnum(title).slice(0, 3) || \"KPL\";\r\n  }\r\n  const counter = String(Math.abs(Date.now()) % 1000).padStart(3, \"0\");\r\n  return `${prefix}-${counter}`;\r\n}\r\n\r\nexport default function AddProduct() {\r\n  const navigate = useNavigate();\r\n\r\n  // product fields\r\n  const [title, setTitle] = useState(\"\");\r\n  const [slug, setSlug] = useState(\"\");\r\n  const [sku, setSku] = useState(\"\");\r\n  const [description, setDescription] = useState(\"\");\r\n  const [price, setPrice] = useState(\"\");\r\n  const [mrp, setMrp] = useState(\"\");\r\n  const [stock, setStock] = useState(\"\");\r\n  const [brand, setBrand] = useState(\"\");\r\n  const [category, setCategory] = useState(\"\");\r\n  const [videoUrl, setVideoUrl] = useState(\"\");\r\n\r\n  // Flags to avoid overriding manual edits\r\n  const [slugEdited, setSlugEdited] = useState(false);\r\n  const [skuEdited, setSkuEdited] = useState(false);\r\n\r\n  // colors as text input + swatches array synced\r\n  const [colorsInput, setColorsInput] = useState(\"\");\r\n  const [swatches, setSwatches] = useState([]); // array of normalized values (hex or label)\r\n  const colorPickerRef = useRef(null);\r\n  const [colorPickerIndex, setColorPickerIndex] = useState(null);\r\n\r\n  // sizes\r\n  const [sizesInput, setSizesInput] = useState(\"\");\r\n\r\n  // file selection / upload\r\n  const fileInputRef = useRef(null);\r\n  const [selectedFiles, setSelectedFiles] = useState([]); // { file, previewUrl }\r\n  const [uploadedImages, setUploadedImages] = useState([]); // { filename, url }\r\n  const [loadingUpload, setLoadingUpload] = useState(false);\r\n  const [saving, setSaving] = useState(false);\r\n  const [message, setMessage] = useState(\"\");\r\n\r\n  // Sync text input -> swatches (when user types)\r\n  useEffect(() => {\r\n    const arr = colorsInput\r\n      ? colorsInput.split(\",\").map(s => s.trim()).filter(Boolean).map(c => normalizeToHexIfPossible(c))\r\n      : [];\r\n    setSwatches(arr);\r\n  }, [colorsInput]);\r\n\r\n  // Keep colorsInput updated when swatches change (so they stay in sync when user uses picker)\r\n  useEffect(() => {\r\n    const s = swatches\r\n      .map(sv => {\r\n        if (!sv) return \"\";\r\n        // prefer named key if present in NAMED_COLORS\r\n        const lower = String(sv).toLowerCase();\r\n        const found = Object.entries(NAMED_COLORS).find(([, v]) => v.toUpperCase() === String(sv).toUpperCase());\r\n        if (found) return found[0].toUpperCase();\r\n        return sv;\r\n      })\r\n      .filter(Boolean)\r\n      .join(\", \");\r\n    setColorsInput(s);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [swatches]);\r\n\r\n  // --- Auto-slug and auto-sku effects ---\r\n\r\n  // Generate slug from title when title changes unless slug edited manually\r\n  useEffect(() => {\r\n    if (!slugEdited) {\r\n      const s = makeSlug(title);\r\n      setSlug(s);\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [title]);\r\n\r\n  // Generate SKU when brand or category (or title as fallback) changes unless sku edited manually\r\n  useEffect(() => {\r\n    if (!skuEdited) {\r\n      const gen = generateSku({ brand: brand || title, category });\r\n      setSku(gen);\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [brand, category, title]);\r\n\r\n  // file selection handler - create previews\r\n  function onFilesChange(e) {\r\n    const files = Array.from(e.target.files || []);\r\n    if (!files.length) return;\r\n    const mapped = files.map((f) => ({ file: f, previewUrl: URL.createObjectURL(f) }));\r\n    setSelectedFiles(prev => [...prev, ...mapped]);\r\n    if (fileInputRef.current) fileInputRef.current.value = \"\";\r\n  }\r\n\r\n  function removeSelectedPreview(idx) {\r\n    setSelectedFiles(prev => {\r\n      const copy = [...prev];\r\n      const removed = copy.splice(idx, 1)[0];\r\n      if (removed && removed.previewUrl) URL.revokeObjectURL(removed.previewUrl);\r\n      return copy;\r\n    });\r\n  }\r\n\r\n  // Upload selectedFiles to backend; returns array of urls\r\n async function uploadFilesIfAny() {\r\n  if (!selectedFiles.length) return [];\r\n  const form = new FormData();\r\n  selectedFiles.forEach(s => form.append(\"files\", s.file));\r\n\r\n  setLoadingUpload(true);\r\n  try {\r\n    // Correct endpoint (same as AdminProductEdit)\r\n    const resp = await axiosInstance.post(\"/api/uploadRoutes/upload\", form, {\r\n      headers: { \"Content-Type\": \"multipart/form-data\" },\r\n      withCredentials: true\r\n    });\r\n\r\n    const data = resp?.data || {};\r\n    let arr = [];\r\n\r\n    if (Array.isArray(data.uploaded)) arr = data.uploaded;\r\n    else if (data.url) arr = [data];\r\n\r\n    const urls = arr.map(it => it.url).filter(Boolean);\r\n    const ui = arr.map((it, i) => ({\r\n      filename: it.filename || `img-${i}`,\r\n      url: it.url\r\n    }));\r\n\r\n    setUploadedImages(prev => [...prev, ...ui]);\r\n    setSelectedFiles([]);\r\n\r\n    return urls;\r\n  } catch (err) {\r\n    console.error(\"Upload failed\", err);\r\n    throw err;\r\n  } finally {\r\n    setLoadingUpload(false);\r\n  }\r\n}\r\n\r\n  // color picker interactions\r\n  function openColorPickerAtIndex(idx) {\r\n    setColorPickerIndex(idx);\r\n    if (colorPickerRef.current) {\r\n      const cur = swatches[idx] || \"#FFFFFF\";\r\n      // ensure hex for input; fallback white\r\n      const normalized = /^#([0-9A-Fa-f]{6})$/.test(String(cur)) ? cur : \"#FFFFFF\";\r\n      colorPickerRef.current.value = normalized;\r\n      colorPickerRef.current.click();\r\n    }\r\n  }\r\n  function onColorPickerChange(e) {\r\n    const val = e.target.value;\r\n    const idx = colorPickerIndex;\r\n    setColorPickerIndex(null);\r\n    if (idx == null) return;\r\n    setSwatches(prev => {\r\n      const copy = [...prev];\r\n      copy[idx] = val.toUpperCase();\r\n      return copy;\r\n    });\r\n  }\r\n  function addSwatch() {\r\n    setSwatches(prev => [...prev, \"#FFFFFF\"]);\r\n  }\r\n  function removeSwatch(i) {\r\n    setSwatches(prev => prev.filter((_, idx) => idx !== i));\r\n  }\r\n\r\n  // Remove uploaded image from list (UI only)\r\n  function removeUploaded(index) {\r\n    setUploadedImages(prev => prev.filter((_, i) => i !== index));\r\n  }\r\n\r\n  // Generate SKU on demand (button)\r\n  function handleGenerateSku() {\r\n    const newSku = generateSku({ brand, category, title });\r\n    setSku(newSku);\r\n    setSkuEdited(true); // treat as manual choice so auto effects won't overwrite\r\n  }\r\n\r\n  // create product handler\r\n  async function handleCreateProduct(e) {\r\n    e?.preventDefault?.();\r\n    setMessage(\"\");\r\n    setSaving(true);\r\n\r\n    try {\r\n      // 1) upload files if any\r\n      let uploadedUrls = [];\r\n      if (selectedFiles.length) {\r\n        uploadedUrls = await uploadFilesIfAny();\r\n        if (uploadedUrls.length === 0) {\r\n          throw new Error(\"No urls returned from upload\");\r\n        }\r\n      }\r\n\r\n      // 2) combine uploadedImages (already stored) + uploadedUrls (defensive)\r\n      const finalImageUrls = (uploadedImages && uploadedImages.length) ? uploadedImages.map(i => i.url) : [];\r\n      if (uploadedUrls && uploadedUrls.length) {\r\n        uploadedUrls.forEach(u => {\r\n          if (!finalImageUrls.includes(u)) finalImageUrls.push(u);\r\n        });\r\n      }\r\n\r\n      // 3) prepare body\r\n      const body = {\r\n        title,\r\n        slug,\r\n        sku,\r\n        description,\r\n        price: Number(price) || 0,\r\n        mrp: Number(mrp) || 0,\r\n        stock: Number(stock) || 0,\r\n        brand,\r\n        category,\r\n        videoUrl: videoUrl || \"\",\r\n        colors: swatches.map(s => s), // array of strings (hex or names)\r\n        sizes: sizesInput ? sizesInput.split(\",\").map(s => s.trim()).filter(Boolean) : [],\r\n        images: finalImageUrls\r\n      };\r\n\r\n      const resp = await axiosInstance.post(\"/api/products\", body, { withCredentials: true });\r\n      const data = resp && resp.data ? resp.data : {};\r\n      if (data && (data.success || data._id || data.id || data.product)) {\r\n        setMessage(\"Product created.\");\r\n        // navigate to admin product list or to edit view for the new product\r\n        const created = data.product || data;\r\n        const id = created._id || created.id || created.slug;\r\n        if (id) {\r\n          navigate(\"/admin/products\");\r\n        } else {\r\n          navigate(\"/admin/products\");\r\n        }\r\n      } else {\r\n        console.error(\"Create product unexpected response\", data);\r\n        throw new Error(\"Create failed, check server response\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Create product error\", err);\r\n      setMessage(\"Create failed: \" + (err.message || String(err)));\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  }\r\n\r\n  // Video embed url for preview\r\n  const embedUrl = getYouTubeEmbedUrl(videoUrl);\r\n\r\n  return (\r\n    <div style={{ padding: 20 }}>\r\n      <div style={{ marginBottom: 12 }}>\r\n        <button type=\"button\" onClick={() => navigate(\"/admin/products\")} style={{ padding: \"6px 10px\" }}>\r\n          Back to products\r\n        </button>\r\n      </div>\r\n\r\n      <h1>Add New Product</h1>\r\n\r\n      <form onSubmit={handleCreateProduct}>\r\n        <div style={{ marginBottom: 8 }}>\r\n          <label style={{ display: \"block\", marginBottom: 4 }}>Title</label>\r\n          <input value={title} onChange={(e) => setTitle(e.target.value)} style={{ width: \"100%\" }} />\r\n        </div>\r\n\r\n        <div style={{ marginBottom: 8 }}>\r\n          <label style={{ display: \"block\", marginBottom: 4 }}>Slug</label>\r\n          <input value={slug} onChange={(e) => { setSlug(e.target.value); setSlugEdited(true); }} placeholder=\"example-product-slug\" style={{ width: \"100%\" }} />\r\n        </div>\r\n\r\n        <div style={{ display: \"flex\", gap: 12 }}>\r\n          <div style={{ flex: 1 }}>\r\n            <label style={{ display: \"block\", marginBottom: 4 }}>Price (₹)</label>\r\n            <input value={price} onChange={(e) => setPrice(e.target.value)} />\r\n          </div>\r\n          <div style={{ flex: 1 }}>\r\n            <label style={{ display: \"block\", marginBottom: 4 }}>MRP (₹)</label>\r\n            <input value={mrp} onChange={(e) => setMrp(e.target.value)} />\r\n          </div>\r\n          <div style={{ flex: 1 }}>\r\n            <label style={{ display: \"block\", marginBottom: 4 }}>Stock</label>\r\n            <input value={stock} onChange={(e) => setStock(e.target.value)} />\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ display: \"flex\", gap: 12, marginTop: 12 }}>\r\n          <div style={{ flex: 1 }}>\r\n            <label style={{ display: \"block\", marginBottom: 4 }}>SKU</label>\r\n            <div style={{ display: \"flex\", gap: 8, alignItems: \"center\" }}>\r\n              <input value={sku} onChange={(e) => { setSku(e.target.value); setSkuEdited(true); }} />\r\n              <button type=\"button\" onClick={handleGenerateSku}>Generate SKU</button>\r\n            </div>\r\n            <div style={{ fontSize: 12, color: \"#555\", marginTop: 6 }}>\r\n              Format: BRAND-CTG-XXX or fallback KPL-XXX (XXX = 3-digit counter)\r\n            </div>\r\n          </div>\r\n          <div style={{ flex: 1 }}>\r\n            <label style={{ display: \"block\", marginBottom: 4 }}>Brand</label>\r\n            <input value={brand} onChange={(e) => setBrand(e.target.value)} />\r\n          </div>\r\n          <div style={{ flex: 1 }}>\r\n            <label style={{ display: \"block\", marginBottom: 4 }}>Category</label>\r\n            <input value={category} onChange={(e) => setCategory(e.target.value)} />\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ marginTop: 12 }}>\r\n          <label style={{ display: \"block\", marginBottom: 4 }}>Description</label>\r\n          <textarea value={description} onChange={(e) => setDescription(e.target.value)} rows={5} style={{ width: \"100%\" }} />\r\n        </div>\r\n\r\n        {/* Colors: text input + swatches (editable with color picker) */}\r\n        <div style={{ marginTop: 12 }}>\r\n          <label style={{ display: \"block\", marginBottom: 6 }}>Colors (comma-separated)</label>\r\n          <input value={colorsInput} onChange={(e) => setColorsInput(e.target.value)} placeholder=\"#1026CB, #1A84C7, red\" style={{ width: \"100%\" }} />\r\n          <div style={{ display: \"flex\", gap: 12, flexWrap: \"wrap\", marginTop: 10, alignItems: \"center\" }}>\r\n            {swatches.map((c, i) => {\r\n              const isHex = /^#([0-9A-Fa-f]{6})$/.test(String(c).trim());\r\n              const bg = isHex ? c : \"#EEE\";\r\n              const suggested = isHex ? (nearestColorName(c) || c) : c;\r\n              return (\r\n                <div key={i} style={{ textAlign: \"center\", minWidth: 72 }}>\r\n                  <div\r\n                    title={String(c)}\r\n                    onClick={() => openColorPickerAtIndex(i)}\r\n                    style={{\r\n                      width: 48,\r\n                      height: 48,\r\n                      borderRadius: 6,\r\n                      border: \"1px solid #ccc\",\r\n                      boxShadow: \"0 1px 6px rgba(0,0,0,0.12)\",\r\n                      background: bg,\r\n                      cursor: \"pointer\"\r\n                    }}\r\n                  />\r\n                  <div style={{ fontSize: 12, marginTop: 6, maxWidth: 80, wordBreak: \"break-word\" }}>\r\n                    {suggested}\r\n                  </div>\r\n                  <div style={{ marginTop: 6 }}>\r\n                    <button type=\"button\" onClick={() => removeSwatch(i)}>Remove</button>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n\r\n            <div style={{ display: \"flex\", alignItems: \"center\" }}>\r\n              <button type=\"button\" onClick={addSwatch}>+ Add color</button>\r\n            </div>\r\n\r\n            {/* hidden color input */}\r\n            <input ref={colorPickerRef} type=\"color\" style={{ display: \"none\" }} onChange={onColorPickerChange} aria-hidden />\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ marginTop: 12 }}>\r\n          <label style={{ display: \"block\", marginBottom: 4 }}>Sizes (comma separated)</label>\r\n          <input value={sizesInput} onChange={(e) => setSizesInput(e.target.value)} placeholder=\"L, XL, XXL\" style={{ width: \"100%\" }} />\r\n        </div>\r\n\r\n        <div style={{ marginTop: 12 }}>\r\n          <label style={{ display: \"block\", marginBottom: 4 }}>Video URL (YouTube)</label>\r\n          <input value={videoUrl} onChange={(e) => setVideoUrl(e.target.value)} style={{ width: \"100%\" }} />\r\n          <div style={{ fontSize: 12, color: \"#555\", marginTop: 6 }}>\r\n            Paste YouTube link (example: https://youtu.be/VIDEOID or https://www.youtube.com/watch?v=VIDEOID)\r\n          </div>\r\n\r\n          {/* video preview */}\r\n          <div style={{ marginTop: 12 }}>\r\n            {videoUrl ? (\r\n              embedUrl ? (\r\n                <div style={{ width: 420, maxWidth: \"100%\", height: 220, border: \"1px solid #eee\", borderRadius: 6, overflow: \"hidden\" }}>\r\n                  <iframe title=\"video-preview\" width=\"100%\" height=\"100%\" src={embedUrl} frameBorder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowFullScreen />\r\n                </div>\r\n              ) : (\r\n                <div style={{ color: \"#666\" }}>Unsupported video URL for inline preview (only YouTube links are embedded).</div>\r\n              )\r\n            ) : (\r\n              <div style={{ color: \"#666\" }}>No video URL provided</div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <hr style={{ margin: \"12px 0\" }} />\r\n\r\n        {/* Images */}\r\n        <div>\r\n          <label style={{ display: \"block\", marginBottom: 6 }}>Images (select one or more)</label>\r\n          <div style={{ margin: \"8px 0\" }}>\r\n            <input ref={fileInputRef} type=\"file\" multiple onChange={onFilesChange} />\r\n            <button type=\"button\" onClick={uploadFilesIfAny} disabled={loadingUpload} style={{ marginLeft: 8 }}>\r\n              {loadingUpload ? \"Uploading…\" : \"Upload selected\"}\r\n            </button>\r\n          </div>\r\n\r\n          <div style={{ display: \"flex\", gap: 8, flexWrap: \"wrap\", marginTop: 8 }}>\r\n            {selectedFiles.map((s, idx) => (\r\n              <div key={s.previewUrl + idx} style={{ border: \"1px solid #eee\", padding: 6, borderRadius: 6 }}>\r\n                <img src={s.previewUrl} alt={`preview-${idx}`} style={{ width: 120, height: 120, objectFit: \"cover\" }} />\r\n                <div style={{ marginTop: 6 }}>\r\n                  <button type=\"button\" onClick={() => removeSelectedPreview(idx)}>Remove</button>\r\n                </div>\r\n              </div>\r\n            ))}\r\n\r\n            {uploadedImages.map((img, idx) => (\r\n              <div key={`up-${idx}`} style={{ border: \"1px solid #eee\", padding: 6, borderRadius: 6 }}>\r\n                <img src={img.url} alt={img.filename} style={{ width: 120, height: 120, objectFit: \"cover\" }} />\r\n                <div style={{ marginTop: 6 }}>\r\n                  <button type=\"button\" onClick={() => removeUploaded(idx)}>Remove</button>\r\n                </div>\r\n              </div>\r\n            ))}\r\n\r\n            {!selectedFiles.length && uploadedImages.length === 0 && <div style={{ color: \"#666\" }}>No files chosen</div>}\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ marginTop: 16 }}>\r\n          <button type=\"submit\" disabled={saving}>{saving ? \"Saving...\" : \"Create Product\"}</button>\r\n          <button type=\"button\" onClick={() => navigate(-1)} style={{ marginLeft: 10 }}>Cancel</button>\r\n        </div>\r\n      </form>\r\n\r\n      {message && <div style={{ marginTop: 12, color: \"crimson\", whiteSpace: \"pre-wrap\" }}>{message}</div>}\r\n    </div>\r\n  );\r\n}\r\n","// frontend/src/admin/AdminAnnouncements.js\r\nimport React, { useEffect, useState } from 'react';\r\n\r\nconst API_BASE = process.env.REACT_APP_API_URL || '';\r\n\r\nexport default function AdminAnnouncements() {\r\n  const [messages, setMessages] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [newText, setNewText] = useState('');\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    async function load() {\r\n      try {\r\n        const res = await fetch(`${API_BASE}/admin-api/settings/announcements`);\r\n        if (!res.ok) throw new Error('Failed to fetch');\r\n        const data = await res.json();\r\n        if (!mounted) return;\r\n        setMessages(Array.isArray(data.messages) ? data.messages : []);\r\n      } catch (err) {\r\n        if (mounted) setError('Unable to load announcements');\r\n      } finally {\r\n        if (mounted) setLoading(false);\r\n      }\r\n    }\r\n    load();\r\n    return () => { mounted = false; };\r\n  }, []);\r\n\r\n  function addMessage() {\r\n    const t = (newText || '').trim();\r\n    if (!t) return;\r\n    setMessages(prev => [...prev, t]);\r\n    setNewText('');\r\n  }\r\n\r\n  function removeMessage(idx) {\r\n    setMessages(prev => prev.filter((_, i) => i !== idx));\r\n  }\r\n\r\n  function moveUp(idx) {\r\n    if (idx <= 0) return;\r\n    setMessages(prev => {\r\n      const copy = [...prev];\r\n      const [item] = copy.splice(idx, 1);\r\n      copy.splice(idx - 1, 0, item);\r\n      return copy;\r\n    });\r\n  }\r\n  function moveDown(idx) {\r\n    setMessages(prev => {\r\n      if (idx >= prev.length - 1) return prev;\r\n      const copy = [...prev];\r\n      const [item] = copy.splice(idx, 1);\r\n      copy.splice(idx + 1, 0, item);\r\n      return copy;\r\n    });\r\n  }\r\n\r\n  async function save() {\r\n    setSaving(true);\r\n    setError(null);\r\n    try {\r\n      const res = await fetch(`${API_BASE}/admin-api/settings/announcements`, {\r\n        method: 'PUT',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ messages })\r\n      });\r\n      if (!res.ok) {\r\n        const txt = await res.text();\r\n        throw new Error(txt || 'Save failed');\r\n      }\r\n      alert('Announcements saved');\r\n    } catch (err) {\r\n      console.error(err);\r\n      setError('Save failed');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  }\r\n\r\n  if (loading) return <div>Loading announcements…</div>;\r\n\r\n  return (\r\n    <div style={{ padding: 12 }}>\r\n      <h3>Announcements</h3>\r\n      {error && <div style={{ color: 'red' }}>{error}</div>}\r\n      <div style={{ marginBottom: 8 }}>\r\n        <input value={newText} onChange={e => setNewText(e.target.value)} style={{ width: '70%', padding: 8 }} placeholder=\"New announcement\" />\r\n        <button onClick={addMessage} style={{ marginLeft: 8, padding: '8px 12px' }}>Add</button>\r\n      </div>\r\n\r\n      <div>\r\n        {messages.length === 0 && <div>No announcements</div>}\r\n        <ul style={{ listStyle: 'none', padding: 0 }}>\r\n          {messages.map((m, i) => (\r\n            <li key={i} style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 6 }}>\r\n              <div style={{ flex: 1 }}>{m}</div>\r\n              <div>\r\n                <button onClick={() => moveUp(i)} disabled={i === 0}>↑</button>\r\n                <button onClick={() => moveDown(i)} disabled={i === messages.length - 1} style={{ marginLeft: 6 }}>↓</button>\r\n                <button onClick={() => removeMessage(i)} style={{ marginLeft: 6 }}>Remove</button>\r\n              </div>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n\r\n      <div style={{ marginTop: 12 }}>\r\n        <button onClick={save} disabled={saving} style={{ padding: '8px 14px' }}>{saving ? 'Saving…' : 'Save announcements'}</button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","// src/admin/AdminPage.jsx\r\nimport React from \"react\";\r\nimport { Routes, Route, Link } from \"react-router-dom\";\r\n\r\nimport AdminLogin from \"./AdminLogin\";                 // ✅ Correct case\r\nimport AdminProductList from \"./AdminProductList\";\r\nimport AdminProductEdit from \"./AdminProductEdit\";\r\nimport AddProduct from \"./AddProduct\";\r\nimport AdminAnnouncements from \"./AdminAnnouncements\";\r\n\r\nexport default function AdminPage() {\r\n  return (\r\n    <div>\r\n      <header style={{ padding: 20, borderBottom: \"1px solid #eee\" }}>\r\n        <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n          <h1 style={{ margin: 0 }}>Admin</h1>\r\n\r\n          <nav>\r\n            <Link to=\"/admin/login\" style={{ marginRight: 12 }}>Login</Link>\r\n            <Link to=\"/admin/products\" style={{ marginRight: 12 }}>Products</Link>\r\n            <Link to=\"/admin/announcements\" style={{ marginRight: 12 }}>Announcements</Link>\r\n            <Link to=\"/\">Back to site</Link>\r\n          </nav>\r\n        </div>\r\n      </header>\r\n\r\n      <main style={{ padding: 20 }}>\r\n        <Routes>\r\n          {/* LOGIN PAGE */}\r\n          <Route path=\"login\" element={<AdminLogin />} />\r\n\r\n          {/* PRODUCTS */}\r\n          <Route path=\"products\" element={<AdminProductList />} />\r\n          <Route path=\"products/new\" element={<AddProduct />} />\r\n          <Route path=\"products/:id\" element={<AdminProductEdit />} />\r\n\r\n          {/* ANNOUNCEMENTS */}\r\n          <Route path=\"announcements\" element={<AdminAnnouncements />} />\r\n\r\n          {/* DEFAULT → Login */}\r\n          <Route path=\"*\" element={<AdminLogin />} />\r\n        </Routes>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["axiosInstance","axios","create","baseURL","process","withCredentials","timeout","interceptors","request","use","config","error","Promise","reject","response","BACKEND_BASE","AdminLogin","phone","setPhone","useState","otp","setOtp","stage","setStage","loading","setLoading","message","setMessage","debug","setDebug","endpointCandidates","concat","verifyCandidates","normalizePhoneInput","p","digits","String","replace","length","startsWith","slice","async","tryPostUntilSuccess","urls","body","u","console","res","fetch","method","headers","JSON","stringify","credentials","text","json","parse","e","ok","raw","status","Object","keys","url","err","warn","_jsxs","style","maxWidth","margin","padding","children","_jsx","color","marginBottom","_Fragment","value","onChange","target","placeholder","width","marginTop","disabled","onClick","normalized","test","result","join","info","trim","setTimeout","window","location","href","marginLeft","fontSize","AdminProductList","products","setProducts","setError","actionMsg","setActionMsg","useNavigate","pickStock","_ref","_ref2","_ref3","_p$stock","stock","qty","inventory","quantity","useEffect","cancelled","token","localStorage","getItem","Authorization","_res$data","get","list","Array","isArray","data","resp","fbErr","fetchProducts","reload","display","justifyContent","gap","Link","to","overflowX","borderCollapse","minWidth","borderBottom","textAlign","map","idx","_p$price","id","_id","slug","thumb","thumbnail","image","images","first","pickThumbnail","sku","src","height","borderRadius","objectFit","background","fontWeight","title","category","price","confirm","prev","filter","_res$data2","delete","_res$data3","success","Error","handleDelete","open","NAMED_COLORS","white","silver","gray","black","red","maroon","yellow","olive","lime","green","aqua","teal","blue","navy","fuchsia","purple","pink","brown","orange","gold","peach","mustard","coral","hexToRgb","hex","r","g","b","clean","parseInt","substring","makeSlug","toLowerCase","sanitizeAlnum","arguments","undefined","toUpperCase","generateSku","brand","c","prefix","pb","pc","counter","Math","abs","Date","now","padStart","AdminProductEdit","useParams","navigate","fileInputRef","useRef","colorPickerRef","colorPickerIndex","setColorPickerIndex","saving","setSaving","product","setProduct","mrp","videoUrl","colors","sizes","description","isPublished","slugEdited","setSlugEdited","skuEdited","setSkuEdited","existingImages","setExistingImages","keepMap","setKeepMap","selectedFiles","setSelectedFiles","swatches","setSwatches","normalizeToHexIfPossible","col","t","full","lower","handleChange","name","checked","_objectSpread","arr","split","s","Boolean","seeded","populateFromProduct","imgs","it","forEach","listResp","found","find","alert","load","previewUrl","URL","revokeObjectURL","mapped","entries","v","onSubmit","preventDefault","bodyForProduct","Number","targetId","created","payload","post","createMinimalProduct","toString","uploadedUrls","pId","_lastErr","_lastErr$response","_lastErr$response$dat","_lastErr2","formData","FormData","append","file","candidates","lastErr","put","uploaded","f","_err$response","uploadFilesToProduct","finalImages","includes","push","finalBody","triedUrls","desc","savedResp","msg","updatedProduct","type","alignItems","newSku","flexWrap","i","isHex","bg","suggestedName","best","bestDist","Infinity","h","dx","dy","dz","dist","_unused","nearestColorName","current","cur","click","openColorPickerAtIndex","border","boxShadow","cursor","wordBreak","_","removeSwatch","ref","val","copy","rows","alt","toggleKeep","multiple","files","from","newSelected","createObjectURL","removeSelectedPreview","index","removed","splice","embed","vMatch","match","short","_unused2","getYouTubeEmbedUrl","allow","allowFullScreen","AddProduct","setTitle","setSlug","setSku","setDescription","setPrice","setMrp","setStock","setBrand","setCategory","setVideoUrl","colorsInput","setColorsInput","sizesInput","setSizesInput","uploadedImages","setUploadedImages","loadingUpload","setLoadingUpload","uploadFilesIfAny","form","ui","filename","sv","gen","embedUrl","origin","host","hostname","pathname","search","vid","searchParams","maybeId","_e$preventDefault","call","finalImageUrls","flex","suggested","rgb","d","overflow","frameBorder","img","removeUploaded","whiteSpace","API_BASE","AdminAnnouncements","messages","setMessages","newText","setNewText","mounted","listStyle","m","item","moveDown","removeMessage","txt","AdminPage","marginRight","Routes","Route","path","element"],"ignoreList":[],"sourceRoot":""}