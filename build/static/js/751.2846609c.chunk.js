"use strict";(self.webpackChunkseemati_ladies_wear=self.webpackChunkseemati_ladies_wear||[]).push([[751],{5026:(e,t,s)=>{s.d(t,{A:()=>n});const i=s(9722).A.create({baseURL:"https://seemati-backend.onrender.com",withCredentials:!0,timeout:6e4});i.interceptors.request.use(e=>e,e=>Promise.reject(e)),i.interceptors.response.use(e=>e,e=>Promise.reject(e));const n=i},9751:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var i=s(5043),n=s(8163),r=s(9379),l=s(5026),a=s(579);function o(){const[e,t]=(0,i.useState)(null),[s,o]=(0,i.useState)(!0),[d,c]=(0,i.useState)(null),[u,p]=(0,i.useState)("");(0,n.Zp)();function h(e){var t,s,i,n,r;return null!==(t=null!==(s=null!==(i=null!==(n=null!==(r=null===e||void 0===e?void 0:e.stock)&&void 0!==r?r:null===e||void 0===e?void 0:e.qty)&&void 0!==n?n:null===e||void 0===e?void 0:e.inventory)&&void 0!==i?i:null===e||void 0===e?void 0:e.quantity)&&void 0!==s?s:null===e||void 0===e?void 0:e.available)&&void 0!==t?t:"-"}return(0,i.useEffect)(()=>{let e=!1;return async function(){console.log("[AdminProductList] Starting fetchProducts"),o(!0),c(null);const s="undefined"!==typeof window&&localStorage.getItem("token")||"undefined"!==typeof window&&localStorage.getItem("authToken")||null,i=s?{Authorization:"Bearer ".concat(s)}:{};let n="";try{n=l.A&&l.A.defaults&&l.A.defaults.baseURL||""}catch(u){n=""}const a="string"===typeof n&&/\/api\/?$/.test(n);console.log("[AdminProductList] axios.defaults.baseURL:",n,"baseHasApi:",a);const d=a?["/products","/admin/products","/products?page=1&limit=200"]:["/api/products","/api/admin/products","/api/products?page=1&limit=200"];for(const r of d)try{console.log("[AdminProductList] Trying axios GET",r);const s=await l.A.get(r,{headers:i});if(console.log("[AdminProductList] axios response for",r,"status:",s&&s.status,"data:",s&&s.data),s&&(200===s.status||s.data)){const i=s.data,n=Array.isArray(i)?i:Array.isArray(null===i||void 0===i?void 0:i.products)?i.products:Array.isArray(null===i||void 0===i?void 0:i.data)?i.data:[];return void(e||(t(n),o(!1),console.log("[AdminProductList] Products set from axios:",n.length)))}}catch(p){console.warn("[AdminProductList] axios GET failed for",r,p&&p.message?p.message:p)}try{const s="".concat("https://api.seemati.in/api","/products");console.log("[AdminProductList] Attempting fallback fetch to",s);const n=await fetch(s,{method:"GET",credentials:"include",headers:(0,r.A)({"Content-Type":"application/json"},i)});if(console.log("[AdminProductList] fallback fetch status:",n.status,n.statusText),!n.ok){const e=await n.text().catch(()=>null);throw new Error("Fallback fetch failed: ".concat(n.status," ").concat(e||n.statusText))}const l=await n.json().catch(e=>{throw new Error("Fallback fetch JSON parse failed: "+(e&&e.message))});console.log("[AdminProductList] fallback fetch json:",l);const a=Array.isArray(l)?l:Array.isArray(null===l||void 0===l?void 0:l.products)?l.products:Array.isArray(null===l||void 0===l?void 0:l.data)?l.data:[];return void(e||(t(a),o(!1),console.log("[AdminProductList] Products set from fallback fetch:",a.length)))}catch(h){console.error("[AdminProductList] fallback fetch failed:",h&&h.message?h.message:h),e||(c(h&&h.message?h.message:"Unable to load products"),o(!1))}}(),()=>{e=!0}},[]),s?(0,a.jsxs)("div",{style:{padding:20},children:[(0,a.jsx)("h2",{children:"Admin \u2014 Products"}),(0,a.jsx)("p",{children:"Loading products\u2026 (open DevTools \u2192 Console to see [AdminProductList] logs)"})]}):d?(0,a.jsxs)("div",{style:{padding:20},children:[(0,a.jsx)("h2",{children:"Admin \u2014 Products"}),(0,a.jsxs)("div",{style:{color:"crimson"},children:["Error loading products: ",String(d)]}),(0,a.jsx)("div",{style:{marginTop:10},children:(0,a.jsx)("button",{onClick:()=>window.location.reload(),children:"Retry"})})]}):e&&0!==e.length?(0,a.jsxs)("div",{style:{padding:20},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsxs)("h2",{style:{margin:0},children:["Admin \u2014 Products (",e.length,")"]}),(0,a.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,a.jsx)(n.N_,{to:"/admin/products/new",children:(0,a.jsx)("button",{style:{padding:"8px 12px"},children:"+ Add product"})}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),children:"Refresh"})]})]}),u&&(0,a.jsx)("div",{style:{marginTop:12},children:u}),(0,a.jsx)("div",{style:{overflowX:"auto",marginTop:16},children:(0,a.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:900},children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{style:{borderBottom:"2px solid #eee",textAlign:"left"},children:[(0,a.jsx)("th",{style:{padding:10},children:"#"}),(0,a.jsx)("th",{style:{padding:10},children:"SKU"}),(0,a.jsx)("th",{style:{padding:10},children:"Thumbnail"}),(0,a.jsx)("th",{style:{padding:10},children:"Name / Slug"}),(0,a.jsx)("th",{style:{padding:10},children:"Category"}),(0,a.jsx)("th",{style:{padding:10},children:"Price"}),(0,a.jsx)("th",{style:{padding:10},children:"Stock"}),(0,a.jsx)("th",{style:{padding:10},children:"Published"}),(0,a.jsx)("th",{style:{padding:10},children:"Actions"})]})}),(0,a.jsx)("tbody",{children:e.map((s,i)=>{var r,o;const d=s._id||s.id||s.slug||i,c=function(e){if(!e)return null;if(e.thumbnail)return e.thumbnail;if(e.image)return e.image;if(e.images&&e.images.length){const t=e.images[0];return t?"string"===typeof t?t:t.url||t.path||t.src||null:null}return null}(s);return(0,a.jsxs)("tr",{style:{borderBottom:"1px solid #f3f3f3"},children:[(0,a.jsx)("td",{style:{padding:10},children:i+1}),(0,a.jsx)("td",{style:{padding:10,width:120},children:s.sku||s.code||"-"}),(0,a.jsx)("td",{style:{padding:10,width:94},children:c?(0,a.jsx)("img",{src:c,alt:s.title||s.name,style:{width:64,height:64,objectFit:"cover",borderRadius:6},onError:e=>e.currentTarget.style.display="none"}):(0,a.jsx)("div",{style:{width:64,height:64,borderRadius:6,background:"#fafafa",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:12},children:"no image"})}),(0,a.jsxs)("td",{style:{padding:10,minWidth:220},children:[(0,a.jsx)("div",{style:{fontWeight:700},children:s.title||s.name||"-"}),(0,a.jsx)("div",{style:{color:"#666",fontSize:13},children:s.slug||"-"})]}),(0,a.jsx)("td",{style:{padding:10},children:s.category||s.cat||"-"}),(0,a.jsx)("td",{style:{padding:10},children:null!==(r=null!==(o=s.price)&&void 0!==o?o:s.mrp)&&void 0!==r?r:"-"}),(0,a.jsx)("td",{style:{padding:10},children:h(s)}),(0,a.jsx)("td",{style:{padding:10},children:s.published?"Yes":"No"}),(0,a.jsx)("td",{style:{padding:10},children:(0,a.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,a.jsx)(n.N_,{to:"/admin/products/".concat(d),children:(0,a.jsx)("button",{style:{padding:"6px 10px"},children:"Edit"})}),(0,a.jsx)("button",{onClick:()=>async function(s){if(!window.confirm("Delete this product? This action cannot be undone."))return;const i=e||[];t(i.filter(e=>(e._id||e.id)!==s)),p("Deleting...");try{const e=["/api/products/".concat(s),"/api/admin/products/".concat(s),"/products/".concat(s),"/admin/products/".concat(s)];let t=!1;for(const s of e)try{const e=await l.A.delete(s);if(e&&(200===e.status||204===e.status||e.data&&e.data.success)){t=!0;break}}catch(n){console.warn("[AdminProductList] delete attempt failed for",s,n&&n.message)}if(!t){const e=await fetch("/api/products/".concat(s),{method:"DELETE",credentials:"include"});if(!e.ok)throw new Error("Delete failed ".concat(e.status))}p("Deleted"),setTimeout(()=>p(""),1200),console.log("[AdminProductList] Deleted product",s)}catch(n){p("Delete failed: ".concat((null===n||void 0===n?void 0:n.message)||"unknown")),t(i),setTimeout(()=>p(""),2500),console.error("[AdminProductList] delete error:",n)}}(d),style:{padding:"6px 10px"},children:"Delete"}),(0,a.jsx)("button",{onClick:()=>{const e=s.slug||s._id||s.id;e?window.open("/product/".concat(e),"_blank"):alert("No slug available")},style:{padding:"6px 10px"},children:"Preview"})]})})]},d)})})]})})]}):(0,a.jsxs)("div",{style:{padding:20},children:[(0,a.jsx)("h2",{children:"Admin \u2014 Products"}),(0,a.jsx)("p",{children:"No products returned from API."}),(0,a.jsx)("p",{children:(0,a.jsx)(n.N_,{to:"/admin/products/new",children:(0,a.jsx)("button",{children:"+ Add product"})})})]})}const d={white:"#FFFFFF",silver:"#C0C0C0",gray:"#808080",black:"#000000",red:"#FF0000",maroon:"#800000",yellow:"#FFFF00",olive:"#808000",lime:"#00FF00",green:"#008000",aqua:"#00FFFF",teal:"#008080",blue:"#0000FF",navy:"#000080",fuchsia:"#FF00FF",purple:"#800080",pink:"#FFC0CB",brown:"#A52A2A",orange:"#FFA500",gold:"#FFD700",peach:"#FFDAB9",mustard:"#FFDB58",coral:"#FF7F50"};function c(e){if(!e)return{r:0,g:0,b:0};const t=e.replace("#","").trim();return 3===t.length?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16)}:{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16)}}function u(e){return e?String(e).toLowerCase().trim().replace(/['"]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").replace(/-+/g,"-"):""}function p(){return String((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"").replace(/[^a-z0-9]/gi,"").toUpperCase()}function h(e){let{brand:t,category:s,title:i}=e;const n=p(t||""),r=p(s||"");let l="KPL";if(n&&r){const e=n.slice(0,3),t=r.slice(0,3);l="".concat(e,"-").concat(t)}else n?l="".concat(n.slice(0,3)):r?l="".concat(r.slice(0,3)):i&&(l=p(i).slice(0,3)||"KPL");const a=String(Math.abs(Date.now())%1e3).padStart(3,"0");return"".concat(l,"-").concat(a)}function g(){const{id:e}=(0,n.g)(),t=(0,n.Zp)(),s=(0,i.useRef)(null),o=(0,i.useRef)(null),[p,g]=(0,i.useState)(null),[m,x]=(0,i.useState)(!0),[y,j]=(0,i.useState)(!1),[f,v]=(0,i.useState)({title:"",slug:"",price:"",mrp:"",stock:"",sku:"",brand:"",category:"",videoUrl:"",colors:"",sizes:"",description:"",isPublished:!1}),[b,w]=(0,i.useState)(!1),[A,k]=(0,i.useState)(!1),[S,C]=(0,i.useState)([]),[F,P]=(0,i.useState)({}),[U,T]=(0,i.useState)([]),[L,E]=(0,i.useState)([]),R=e=>{if(!e)return"";const t=e.trim();if(/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/.test(t)){const e=t.replace("#",""),s=3===e.length?e[0]+e[0]+e[1]+e[1]+e[2]+e[2]:e;return"#".concat(s.toUpperCase())}const s=t.toLowerCase();return d[s]?d[s].toUpperCase():t};function z(e){const{name:t,value:s,checked:i}=e.target;if("isPublished"===t)v(e=>(0,r.A)((0,r.A)({},e),{},{isPublished:!!i}));else if("slug"===t&&w(!0),"sku"===t&&k(!0),v(e=>(0,r.A)((0,r.A)({},e),{},{[t]:s})),"colors"===t){const e=(n=s,n?n.split(",").map(e=>e.trim()).filter(Boolean):[]).map(e=>R(e));E(e)}var n}return(0,i.useEffect)(()=>{let t=!1;if(!e)return x(!1),C([]),P({}),E([]),v(e=>{const t=(0,r.A)({},e);return!t.slug&&t.title&&(t.slug=u(t.title)),t.sku||(t.sku=h({brand:t.brand,category:t.category,title:t.title})),t}),()=>{t=!0};function s(e){v({title:e.title||"",slug:e.slug||"",price:e.price||"",mrp:e.mrp||"",stock:e.stock||"",sku:e.sku||"",brand:e.brand||"",category:e.category||"",videoUrl:e.videoUrl||"",colors:Array.isArray(e.colors)?e.colors.join(", "):e.colors||"",sizes:Array.isArray(e.sizes)?e.sizes.join(", "):e.sizes||"",description:e.description||"",isPublished:!!e.isPublished}),e.slug&&w(!0),e.sku&&k(!0);const t=Array.isArray(e.images)?e.images.map(e=>"string"===typeof e?e:e.url||e):[];C(t);const s={};t.forEach(e=>s[e]=!0),P(s);const i=(Array.isArray(e.colors)?e.colors:e.colors?e.colors.split(",").map(e=>e.trim()):[]).map(e=>R(e));E(i)}return async function(){try{x(!0);try{const t=await l.A.get("/api/products/".concat(e));if(t&&t.data){const e=t.data.product||t.data.success&&t.data.products&&t.data.products[0]||t.data;if(e&&"object"===typeof e)return s(e),void x(!1)}}catch(i){console.warn("Direct GET failed, falling back to list",i&&i.response?i.response.status:i.message)}try{const t=await l.A.get("/api/products"),i=t&&t.data&&(t.data.products||t.data)||[];if(Array.isArray(i)&&i.length){let t=i.find(t=>String(t._id)===String(e));if(t||(t=i.find(t=>t.slug===e||String(t.slug)===String(e))),t)return s(t),void x(!1)}alert("Product not found on server.")}catch(i){console.error("Products list fallback failed",i),alert("Failed to load product list fallback. See console.")}}finally{t||x(!1)}}(),()=>{t=!0,U.forEach(e=>e.previewUrl&&URL.revokeObjectURL(e.previewUrl))}},[e]),(0,i.useEffect)(()=>{const e=L.map(e=>{if(!e)return"";const t=Object.entries(d).find(t=>{let[,s]=t;return s.toUpperCase()===e.toUpperCase()});return t?t[0].toUpperCase():e}).filter(Boolean).join(", ");v(t=>(0,r.A)((0,r.A)({},t),{},{colors:e}))},[L]),(0,i.useEffect)(()=>{b||v(e=>(0,r.A)((0,r.A)({},e),{},{slug:u(e.title||"")}))},[f.title,b]),(0,i.useEffect)(()=>{if(!A){const e=h({brand:f.brand,category:f.category,title:f.title});v(t=>(0,r.A)((0,r.A)({},t),{},{sku:e}))}},[f.brand,f.category,f.title,A]),m?(0,a.jsx)("div",{children:"Loading..."}):(0,a.jsxs)("div",{style:{display:"flex",gap:40,padding:12},children:[(0,a.jsxs)("form",{onSubmit:async function(s){s.preventDefault(),j(!0);try{const s={title:f.title,slug:f.slug,price:Number(f.price)||0,mrp:Number(f.mrp)||0,stock:Number(f.stock)||0,sku:f.sku,brand:f.brand,category:f.category,videoUrl:f.videoUrl,description:f.description,isPublished:!!f.isPublished,colors:L.map(e=>e),sizes:f.sizes?f.sizes.split(",").map(e=>e.trim()).filter(Boolean):[]};let n=e;if(!n){s.slug||(s.slug=u(s.title||"")),s.sku||(s.sku=h({brand:s.brand,category:s.category,title:s.title}));const e=await async function(e){const t={title:e.title||"Untitled product",slug:e.slug||"",price:Number(e.price)||0,mrp:Number(e.mrp)||0,stock:Number(e.stock)||0,sku:e.sku||"",brand:e.brand||"",category:e.category||"",videoUrl:e.videoUrl||"",description:e.description||"",isPublished:!!e.isPublished,colors:e.colors||[],sizes:e.sizes||[],images:[]},s=await l.A.post("/api/products",t),i=s&&s.data?s.data.product||s.data:null;if(!i)throw new Error("Create product failed: no product returned");return i}(s);if(n=e._id||e.id||e._id&&e._id.toString(),!n)throw new Error("Could not obtain new product id from create response");v(t=>(0,r.A)((0,r.A)({},t),{},{slug:e.slug||t.slug,sku:e.sku||t.sku}))}let a=[];if(U.length)try{a=await async function(e){var t,s,i,n;if(!U.length)return[];if(!e)throw new Error("Missing product id for upload");const r=new FormData;U.forEach(e=>r.append("images",e.file));const a=[{method:"put",url:"/api/uploadRoutes/".concat(e,"/upload")},{method:"post",url:"/api/uploadRoutes/upload"}];let o=null;for(const u of a)try{let e;e="put"===u.method?await l.A.put(u.url,r,{headers:{"Content-Type":"multipart/form-data"}}):await l.A.post(u.url,r,{headers:{"Content-Type":"multipart/form-data"}});const t=e.data||{};return(Array.isArray(t.uploaded)&&t.uploaded||(t.url?[{url:t.url}]:[])).map(e=>e.url)}catch(c){var d;o=c,console.warn("UPLOAD FAIL @ ".concat(u.url),null===c||void 0===c||null===(d=c.response)||void 0===d?void 0:d.status)}throw new Error((null===(t=o)||void 0===t||null===(s=t.response)||void 0===s||null===(i=s.data)||void 0===i?void 0:i.error)||(null===(n=o)||void 0===n?void 0:n.message)||"Upload failed")}(n)}catch(i){throw console.error("Upload request failed",i),new Error("Upload request failed: "+(i.message||i))}const o=[...S.filter(e=>F[e])];a.forEach(e=>{o.includes(e)||o.push(e)});const d=(0,r.A)((0,r.A)({},s),{},{images:o}),c=[{url:"/api/products/".concat(n),desc:"public"},{url:"/api/admin/product/".concat(n),desc:"admin (api/admin/product)"},{url:"/api/admin/products/".concat(n),desc:"admin (api/admin/products)"},{url:"/api/adminProduct/products/".concat(n),desc:"adminProduct (api/adminProduct/products)"}];let p=null,g=null;for(const e of c)try{const t=await l.A.put(e.url,d);if(t&&t.status>=200&&t.status<300){p=t;break}}catch(i){g=i,console.warn("[save] PUT ".concat(e.url," failed"),i&&i.response&&i.response.status?i.response.status:i.message)}if(!p){console.error("All update attempts failed",g);const e=g&&g.response&&g.response.data&&g.response.data.message?g.response.data.message:g&&g.message||"Save failed on all attempted update endpoints";throw new Error(e)}U.forEach(e=>e.previewUrl&&URL.revokeObjectURL(e.previewUrl)),T([]);const m=p.data.product||p.data,x=Array.isArray(m.images)?m.images.map(e=>"string"===typeof e?e:e.url||e):[];C(x);const y={};x.forEach(e=>y[e]=!0),P(y),alert(e?"Product updated.":"Product created and saved."),!e&&n&&t("/admin/products/".concat(n,"/edit"))}catch(i){console.error("Save error",i);const e=i&&i.response&&i.response.data&&(i.response.data.message||JSON.stringify(i.response.data))||i&&i.message||"Save failed";alert(e)}finally{j(!1)}},style:{width:"40%"},children:[(0,a.jsx)("div",{style:{marginBottom:10},children:(0,a.jsx)("button",{type:"button",onClick:()=>t("/admin/products"),children:"Back to products"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Title"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{name:"title",value:f.title,onChange:z,style:{width:"100%"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Slug"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{name:"slug",value:f.slug,onChange:e=>{z(e),w(!0)},style:{width:"100%"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Price"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{name:"price",value:f.price,onChange:z,style:{width:"100%"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"MRP"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{name:"mrp",value:f.mrp,onChange:z,style:{width:"100%"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Stock"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{name:"stock",value:f.stock,onChange:z,style:{width:"100%"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"SKU"}),(0,a.jsx)("br",{}),(0,a.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,a.jsx)("input",{name:"sku",value:f.sku,onChange:e=>{z(e),k(!0)},style:{width:"100%"}}),(0,a.jsx)("button",{type:"button",onClick:function(){const e=h({brand:f.brand,category:f.category,title:f.title});v(t=>(0,r.A)((0,r.A)({},t),{},{sku:e})),k(!0)},children:"Generate SKU"})]}),(0,a.jsx)("div",{style:{fontSize:12,color:"#555",marginTop:6},children:"Format: BRAND-CTG-XXX or fallback KPL-XXX (XXX = 3-digit counter)"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Brand"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{name:"brand",value:f.brand,onChange:z,style:{width:"100%"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Category"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{name:"category",value:f.category,onChange:z,style:{width:"100%"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Video URL (YouTube)"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{name:"videoUrl",value:f.videoUrl,onChange:z,style:{width:"100%"}}),(0,a.jsx)("div",{style:{fontSize:12,marginTop:6,color:"#555"},children:"Paste YouTube link (example: https://youtu.be/VIDEOID or https://www.youtube.com/watch?v=VIDEOID)"})]}),(0,a.jsxs)("div",{style:{marginTop:12},children:[(0,a.jsx)("label",{children:"Colors (comma-separated)"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{name:"colors",value:f.colors,onChange:z,style:{width:"100%"}}),(0,a.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginTop:10,alignItems:"center"},children:[L.map((e,t)=>{const s=/^#([0-9A-F]{6})$/i.test(String(e).trim()),i=s?e:"#EEE",n=s?function(e){try{const t=c(e);let s=null,i=1/0;return Object.entries(d).forEach(e=>{let[n,r]=e;const l=c(r),a=t.r-l.r,o=t.g-l.g,d=t.b-l.b,u=a*a+o*o+d*d;u<i&&(i=u,s=n)}),s||""}catch(t){return""}}(e):String(e)||"";return(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)("div",{title:String(e),onClick:()=>function(e){if(g(e),o.current){const t=L[e]||"#FFFFFF",s=R(t)||"#FFFFFF";o.current.value=s,o.current.click()}}(t),style:{width:48,height:48,borderRadius:6,border:"1px solid #ccc",boxShadow:"0 1px 6px rgba(0,0,0,0.12)",background:i,cursor:"pointer"}}),(0,a.jsx)("div",{style:{fontSize:12,marginTop:6,maxWidth:80,wordBreak:"break-word"},children:n||String(e).slice(0,12)}),(0,a.jsx)("div",{style:{marginTop:6},children:(0,a.jsx)("button",{type:"button",onClick:()=>function(e){E(t=>t.filter((t,s)=>s!==e))}(t),children:"Remove"})})]},t)}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"button",onClick:function(){E(e=>[...e,"#FFFFFF"])},children:"+ Add color"})}),(0,a.jsx)("input",{ref:o,type:"color",style:{display:"none"},onChange:function(e){const t=e.target.value,s=p;g(null),null!=s&&E(e=>{const i=[...e];return i[s]=t.toUpperCase(),i})},"aria-hidden":"true"})]})]}),(0,a.jsxs)("div",{style:{marginTop:12},children:[(0,a.jsx)("label",{children:"Sizes (comma-separated)"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{name:"sizes",value:f.sizes,onChange:z,style:{width:"100%"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Description"}),(0,a.jsx)("br",{}),(0,a.jsx)("textarea",{name:"description",value:f.description,onChange:z,rows:6,style:{width:"100%"}})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{children:[(0,a.jsx)("input",{name:"isPublished",type:"checkbox",checked:f.isPublished,onChange:z})," Published"]})}),(0,a.jsxs)("div",{style:{marginTop:8},children:[(0,a.jsx)("button",{type:"submit",disabled:y,children:y?"Saving...":e?"Save":"Create product"}),(0,a.jsx)("button",{type:"button",onClick:()=>t("/admin/products"),children:"Cancel"})]})]}),(0,a.jsxs)("div",{style:{width:"50%"},children:[(0,a.jsx)("h3",{children:"Existing Images"}),(0,a.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[S.map((e,t)=>(0,a.jsxs)("div",{style:{textAlign:"center",width:120},children:[(0,a.jsx)("img",{src:e,alt:"img-".concat(t),style:{width:100,height:100,objectFit:"cover"}}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{children:[(0,a.jsx)("input",{type:"checkbox",checked:!!F[e],onChange:()=>function(e){P(t=>(0,r.A)((0,r.A)({},t),{},{[e]:!t[e]}))}(e)})," Keep"]})}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"button",onClick:()=>{P(t=>(0,r.A)((0,r.A)({},t),{},{[e]:!1}))},children:"Remove"})})]},e)),0===S.length&&(0,a.jsx)("div",{children:"No existing images"})]}),(0,a.jsx)("h3",{style:{marginTop:16},children:"Add Images"}),(0,a.jsx)("input",{ref:s,type:"file",multiple:!0,onChange:function(e){const t=Array.from(e.target.files||[]);if(!t.length)return;const i=t.map(e=>({file:e,previewUrl:URL.createObjectURL(e)}));T(e=>[...e,...i]),s.current&&(s.current.value="")}}),(0,a.jsxs)("div",{style:{marginTop:8,display:"flex",gap:12,flexWrap:"wrap"},children:[U.map((e,t)=>(0,a.jsxs)("div",{style:{textAlign:"center",width:120},children:[(0,a.jsx)("img",{src:e.previewUrl,alt:"preview-".concat(t),style:{width:100,height:100,objectFit:"cover"}}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"button",onClick:()=>{return e=t,void T(t=>{const s=[...t],i=s.splice(e,1)[0];return i&&i.previewUrl&&URL.revokeObjectURL(i.previewUrl),s});var e},children:"Remove"})})]},e.previewUrl+t)),0===U.length&&(0,a.jsx)("div",{children:"No files chosen"})]}),(0,a.jsxs)("div",{style:{marginTop:20},children:[(0,a.jsx)("h4",{children:"Video preview"}),f.videoUrl?(()=>{const e=function(e){if(!e)return null;try{const t=e.trim(),s=t.match(/[?&]v=([^&]+)/);if(s)return"https://www.youtube.com/embed/".concat(s[1]);const i=t.match(/youtu\.be\/([^?&]+)/);return i?"https://www.youtube.com/embed/".concat(i[1]):t.includes("youtube.com/embed/")?t:null}catch(t){return null}}(f.videoUrl);return e?(0,a.jsx)("div",{style:{width:"100%",height:250},children:(0,a.jsx)("iframe",{title:"video-preview",src:e,style:{width:"100%",height:"100%",border:"none"},allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}):(0,a.jsx)("div",{children:"Unsupported video URL (currently only YouTube links are previewed)."})})():(0,a.jsx)("div",{children:"No video URL provided"})]})]})]})}function m(e){var t,s,n;let{initial:r={},onSave:l,saving:o=!1}=e;const[d,c]=(0,i.useState)(r.title||""),[u,p]=(0,i.useState)(r.description||""),[h,g]=(0,i.useState)(null!==(t=r.price)&&void 0!==t?t:""),[m,x]=(0,i.useState)(null!==(s=r.mrp)&&void 0!==s?s:""),[y,j]=(0,i.useState)(null!==(n=r.stock)&&void 0!==n?n:""),[f,v]=(0,i.useState)(r.sku||""),[b,w]=(0,i.useState)(r.brand||""),[A,k]=(0,i.useState)(r.category||""),[S,C]=(0,i.useState)(Array.isArray(r.sizes)?r.sizes.join(","):r.sizes||""),[F,P]=(0,i.useState)(Array.isArray(r.colors)?r.colors.join(","):r.colors||""),[U,T]=(0,i.useState)([]);return(0,i.useEffect)(()=>{var e,t,s;c(r.title||""),p(r.description||""),g(null!==(e=r.price)&&void 0!==e?e:""),x(null!==(t=r.mrp)&&void 0!==t?t:""),j(null!==(s=r.stock)&&void 0!==s?s:""),v(r.sku||""),w(r.brand||""),k(r.category||""),C(Array.isArray(r.sizes)?r.sizes.join(","):r.sizes||""),P(Array.isArray(r.colors)?r.colors.join(","):r.colors||""),T([])},[r]),(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault();const t=function(){const e=S&&S.trim()?S.split(",").map(e=>e.trim()).filter(Boolean):[],t=F&&F.trim()?F.split(",").map(e=>e.trim()).filter(Boolean):[];return{title:d.trim(),description:u.trim(),price:Number(h||0),mrp:Number(m||0),stock:Number(y||0),sku:f.trim(),brand:b.trim(),category:A.trim(),sizes:e,colors:t}}();"function"===typeof l&&l(t,U)},children:(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 220px",gap:12},children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{style:{display:"block",marginBottom:6},children:["Title",(0,a.jsx)("input",{value:d,onChange:e=>c(e.target.value),required:!0,style:{width:"100%",padding:8,marginTop:6}})]}),(0,a.jsxs)("label",{style:{display:"block",marginBottom:6},children:["Description",(0,a.jsx)("textarea",{value:u,onChange:e=>p(e.target.value),rows:6,style:{width:"100%",padding:8,marginTop:6}})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,a.jsxs)("label",{style:{flex:1},children:["Price",(0,a.jsx)("br",{}),(0,a.jsx)("input",{type:"number",value:h,onChange:e=>g(e.target.value),style:{width:"100%",padding:8}})]}),(0,a.jsxs)("label",{style:{width:160},children:["MRP",(0,a.jsx)("br",{}),(0,a.jsx)("input",{type:"number",value:m,onChange:e=>x(e.target.value),style:{width:"100%",padding:8}})]})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:8,marginTop:8},children:[(0,a.jsxs)("label",{style:{width:160},children:["Stock",(0,a.jsx)("br",{}),(0,a.jsx)("input",{type:"number",value:y,onChange:e=>j(e.target.value),style:{width:"100%",padding:8}})]}),(0,a.jsxs)("label",{style:{flex:1},children:["SKU",(0,a.jsx)("br",{}),(0,a.jsx)("input",{value:f,onChange:e=>v(e.target.value),style:{width:"100%",padding:8}})]})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:8,marginTop:8},children:[(0,a.jsxs)("label",{style:{flex:1},children:["Brand",(0,a.jsx)("br",{}),(0,a.jsx)("input",{value:b,onChange:e=>w(e.target.value),style:{width:"100%",padding:8}})]}),(0,a.jsxs)("label",{style:{width:200},children:["Category",(0,a.jsx)("br",{}),(0,a.jsx)("input",{value:A,onChange:e=>k(e.target.value),style:{width:"100%",padding:8}})]})]}),(0,a.jsxs)("label",{style:{display:"block",marginTop:8},children:["Sizes (comma separated)",(0,a.jsx)("br",{}),(0,a.jsx)("input",{value:S,onChange:e=>C(e.target.value),placeholder:"S,M,L",style:{width:"100%",padding:8,marginTop:6}})]}),(0,a.jsxs)("label",{style:{display:"block",marginTop:8},children:["Colors (comma separated)",(0,a.jsx)("br",{}),(0,a.jsx)("input",{value:F,onChange:e=>P(e.target.value),placeholder:"red,blue",style:{width:"100%",padding:8,marginTop:6}})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{style:{display:"block",marginBottom:8},children:["Upload images",(0,a.jsx)("br",{}),(0,a.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:function(e){T(Array.from(e.target.files||[]))}})]}),U.length>0&&(0,a.jsxs)("div",{style:{marginTop:8},children:[(0,a.jsx)("div",{children:"Files to upload:"}),(0,a.jsx)("ul",{children:U.map((e,t)=>(0,a.jsxs)("li",{children:[e.name," \u2014 ",Math.round(e.size/1024)," KB"]},t))})]}),(0,a.jsxs)("div",{style:{marginTop:16},children:[(0,a.jsx)("button",{type:"submit",disabled:o,style:{padding:"8px 16px",marginRight:8},children:o?"Saving\u2026":"Save"}),(0,a.jsx)("button",{type:"button",onClick:()=>{},style:{padding:"8px 16px"},children:"Cancel"})]})]})]})})}const x="https://api.seemati.in/api";function y(){const[e,t]=(0,i.useState)([]),[s,n]=(0,i.useState)(!0),[r,l]=(0,i.useState)(!1),[o,d]=(0,i.useState)(null),[c,u]=(0,i.useState)("");return(0,i.useEffect)(()=>{let e=!0;return async function(){try{const s=await fetch("".concat(x,"/admin-api/settings/announcements"));if(!s.ok)throw new Error("Failed to fetch");const i=await s.json();if(!e)return;t(Array.isArray(i.messages)?i.messages:[])}catch(s){e&&d("Unable to load announcements")}finally{e&&n(!1)}}(),()=>{e=!1}},[]),s?(0,a.jsx)("div",{children:"Loading announcements\u2026"}):(0,a.jsxs)("div",{style:{padding:12},children:[(0,a.jsx)("h3",{children:"Announcements"}),o&&(0,a.jsx)("div",{style:{color:"red"},children:o}),(0,a.jsxs)("div",{style:{marginBottom:8},children:[(0,a.jsx)("input",{value:c,onChange:e=>u(e.target.value),style:{width:"70%",padding:8},placeholder:"New announcement"}),(0,a.jsx)("button",{onClick:function(){const e=(c||"").trim();e&&(t(t=>[...t,e]),u(""))},style:{marginLeft:8,padding:"8px 12px"},children:"Add"})]}),(0,a.jsxs)("div",{children:[0===e.length&&(0,a.jsx)("div",{children:"No announcements"}),(0,a.jsx)("ul",{style:{listStyle:"none",padding:0},children:e.map((s,i)=>(0,a.jsxs)("li",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[(0,a.jsx)("div",{style:{flex:1},children:s}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:()=>{var e;(e=i)<=0||t(t=>{const s=[...t],[i]=s.splice(e,1);return s.splice(e-1,0,i),s})},disabled:0===i,children:"\u2191"}),(0,a.jsx)("button",{onClick:()=>{return e=i,void t(t=>{if(e>=t.length-1)return t;const s=[...t],[i]=s.splice(e,1);return s.splice(e+1,0,i),s});var e},disabled:i===e.length-1,style:{marginLeft:6},children:"\u2193"}),(0,a.jsx)("button",{onClick:()=>{return e=i,void t(t=>t.filter((t,s)=>s!==e));var e},style:{marginLeft:6},children:"Remove"})]})]},i))})]}),(0,a.jsx)("div",{style:{marginTop:12},children:(0,a.jsx)("button",{onClick:async function(){l(!0),d(null);try{const t=await fetch("".concat(x,"/admin-api/settings/announcements"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:e})});if(!t.ok){const e=await t.text();throw new Error(e||"Save failed")}alert("Announcements saved")}catch(t){console.error(t),d("Save failed")}finally{l(!1)}},disabled:r,style:{padding:"8px 14px"},children:r?"Saving\u2026":"Save announcements"})})]})}function j(){return console.debug("[AdminPage] mounted, location:",window.location.pathname),(0,a.jsxs)("div",{children:[(0,a.jsx)("header",{style:{padding:20,borderBottom:"1px solid #eee"},children:(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsx)("h1",{style:{margin:0},children:"Admin"}),(0,a.jsxs)("nav",{children:[(0,a.jsx)(n.N_,{to:"/admin/products",style:{marginRight:12},children:"Products"}),(0,a.jsx)(n.N_,{to:"/admin/announcements",style:{marginRight:12},children:"Announcements"}),(0,a.jsx)(n.N_,{to:"/",children:"Back to site"})]})]})}),(0,a.jsx)("main",{style:{padding:20},children:(0,a.jsxs)(n.BV,{children:[(0,a.jsx)(n.qh,{path:"products",element:(0,a.jsx)(o,{})}),(0,a.jsx)(n.qh,{path:"products/new",element:(0,a.jsx)(m,{})}),(0,a.jsx)(n.qh,{path:"products/:id",element:(0,a.jsx)(g,{})}),(0,a.jsx)(n.qh,{path:"announcements",element:(0,a.jsx)(y,{})}),(0,a.jsx)(n.qh,{path:"*",element:(0,a.jsx)(o,{})})]})})]})}}}]);
//# sourceMappingURL=751.2846609c.chunk.js.map