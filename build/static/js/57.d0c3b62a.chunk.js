"use strict";(self.webpackChunkseemati_ladies_wear=self.webpackChunkseemati_ladies_wear||[]).push([[57],{5026:(e,t,n)=>{n.d(t,{A:()=>i});const r=n(9722).A.create({baseURL:"https://seemati-backend.onrender.com",withCredentials:!0,timeout:6e4});r.interceptors.request.use(e=>e,e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>Promise.reject(e));const i=r},8057:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var r=n(5043),i=n(8163),s=n(579);const o="https://seemati-backend.onrender.com";function l(){const[e,t]=(0,r.useState)(""),[n,i]=(0,r.useState)(""),[l,a]=(0,r.useState)("enter"),[c,d]=(0,r.useState)(!1),[u,p]=(0,r.useState)(""),[h,g]=(0,r.useState)(""),m=["".concat(o,"/api/auth/send-otp"),"".concat(o,"/api/otp/send"),"".concat(o,"/api/otpRoutes/send"),"".concat(o,"/api/otp/send"),"".concat(o,"/auth/send-otp"),"".concat(o,"/otp/send"),"".concat(o,"/otpRoutes/send")],y=["".concat(o,"/api/auth/verify-otp"),"".concat(o,"/api/otp/verify"),"".concat(o,"/api/otpRoutes/verify"),"".concat(o,"/auth/verify-otp"),"".concat(o,"/otp/verify"),"".concat(o,"/otpRoutes/verify")];function x(e){if(!e)return"";const t=String(e).replace(/\D/g,"");return 12===t.length&&t.startsWith("91")?t.slice(2):11===t.length&&t.startsWith("0")?t.slice(1):t}async function f(e,t){for(const i of e)try{console.debug("[AdminLogin] trying",i,t),g("Trying ".concat(i));const e=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"}),r=await e.text();let s;try{s=r?JSON.parse(r):{}}catch(n){s={ok:!1,error:"bad_json",raw:r}}if(console.debug("[AdminLogin] response from",i,e.status,s),e.status>=200&&e.status<300&&(!0===s.ok||Object.keys(s).length>0))return{url:i,res:e,json:s};continue}catch(r){console.warn("[AdminLogin] network error for",i,r&&r.message?r.message:r);continue}return null}return(0,s.jsxs)("div",{style:{maxWidth:720,margin:"0 auto",padding:24},children:[(0,s.jsx)("h1",{children:"Admin Login"}),u&&(0,s.jsx)("div",{style:{color:"red",marginBottom:12},children:u}),"enter"===l&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("label",{children:"Phone Number"}),(0,s.jsx)("input",{value:e,onChange:e=>t(e.target.value),placeholder:"10-digit phone (eg. 9042163246)",style:{width:"100%",padding:8,marginTop:6},disabled:c}),(0,s.jsx)("div",{style:{marginTop:10},children:(0,s.jsx)("button",{onClick:async function(){p(""),g("");const t=x(e);if(/^\d{10}$/.test(t)){d(!0);try{const e={phone:t},n=await f(m,e);if(!n)return p("Failed to send OTP \u2014 no candidate endpoint responded (404/500). See console for details."),void g("Tried endpoints: "+m.join(", "));console.info("[AdminLogin] OTP send succeeded at",n.url,n.json),p(n.json&&(n.json.message||n.json.error||"OTP sent.")),a("verify"),g("Used ".concat(n.url))}catch(n){console.error("[AdminLogin] sendOtp error:",n),p("Network error sending OTP")}finally{d(!1)}}else p("Enter a valid 10-digit phone number (digits only).")},disabled:c,children:c?"Sending...":"Send OTP"})})]}),"verify"===l&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("label",{children:"OTP"}),(0,s.jsx)("input",{value:n,onChange:e=>i(e.target.value),placeholder:"Enter the OTP",style:{width:"100%",padding:8,marginTop:6},disabled:c}),(0,s.jsxs)("div",{style:{marginTop:10},children:[(0,s.jsx)("button",{onClick:async function(){p(""),g("");const t=x(e);if(/^\d{10}$/.test(t))if(n&&/^\d{3,6}$/.test(String(n).trim())){d(!0);try{const e={phone:t,otp:String(n).trim()},r=await f(y,e);if(!r)return p("OTP verification failed \u2014 no endpoint accepted the request."),void g("Tried verify endpoints: "+y.join(", "));console.info("[AdminLogin] verify succeeded at",r.url,r.json),r.json&&r.json.ok?(p("Logged in \u2014 redirecting to admin..."),g("Used ".concat(r.url)),setTimeout(()=>window.location.href="/admin/products",400)):p(r.json&&(r.json.message||r.json.error)?r.json.message||r.json.error:"OTP verification failed")}catch(r){console.error("[AdminLogin] verifyOtp error:",r),p("Network error verifying OTP")}finally{d(!1)}}else p("Enter the OTP code.");else p("Enter a valid phone first.")},disabled:c,children:c?"Verifying...":"Verify OTP"}),(0,s.jsx)("button",{onClick:()=>{a("enter"),p(""),i("")},style:{marginLeft:10},children:"Change number"})]})]}),(0,s.jsxs)("div",{style:{marginTop:14,color:"#666",fontSize:13},children:["Debug: ",h||"none"," ",(0,s.jsx)("br",{}),"Backend base: ",o]})]})}var a=n(5026);function c(){const[e,t]=(0,r.useState)(null),[n,o]=(0,r.useState)(!0),[l,c]=(0,r.useState)(null),[d,u]=(0,r.useState)("");(0,i.Zp)();function p(e){var t,n,r,i;return null!==(t=null!==(n=null!==(r=null!==(i=null===e||void 0===e?void 0:e.stock)&&void 0!==i?i:null===e||void 0===e?void 0:e.qty)&&void 0!==r?r:null===e||void 0===e?void 0:e.inventory)&&void 0!==n?n:null===e||void 0===e?void 0:e.quantity)&&void 0!==t?t:"-"}return(0,r.useEffect)(()=>{let e=!1;return async function(){o(!0),c(null);const n=localStorage.getItem("token")||localStorage.getItem("authToken")||null,r=n?{Authorization:"Bearer ".concat(n)}:{};try{var i;const n=await a.A.get("/api/products",{headers:r}),s=Array.isArray(null===(i=n.data)||void 0===i?void 0:i.products)?n.data.products:Array.isArray(n.data)?n.data:[];return void(e||(t(s),o(!1)))}catch(s){console.warn("Primary product load failed, trying fallback",s)}try{const n=await fetch("".concat("https://api.seemati.in/api","/products")),r=await n.json(),i=Array.isArray(null===r||void 0===r?void 0:r.products)?r.products:Array.isArray(r)?r:[];e||(t(i),o(!1))}catch(l){e||(c("Unable to load products"),o(!1))}}(),()=>{e=!0}},[]),n?(0,s.jsxs)("div",{style:{padding:20},children:[(0,s.jsx)("h2",{children:"Admin \u2014 Products"}),(0,s.jsx)("p",{children:"Loading products\u2026"})]}):l?(0,s.jsxs)("div",{style:{padding:20},children:[(0,s.jsx)("h2",{children:"Admin \u2014 Products"}),(0,s.jsx)("div",{style:{color:"crimson"},children:l}),(0,s.jsx)("button",{onClick:()=>window.location.reload(),children:"Retry"})]}):e&&0!==e.length?(0,s.jsxs)("div",{style:{padding:20},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsxs)("h2",{children:["Admin \u2014 Products (",e.length,")"]}),(0,s.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,s.jsx)(i.N_,{to:"/admin/products/new",children:(0,s.jsx)("button",{children:"+ Add product"})}),(0,s.jsx)("button",{onClick:()=>window.location.reload(),children:"Refresh"})]})]}),d&&(0,s.jsx)("div",{style:{marginTop:12},children:d}),(0,s.jsx)("div",{style:{overflowX:"auto",marginTop:16},children:(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:900},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{borderBottom:"2px solid #eee",textAlign:"left"},children:[(0,s.jsx)("th",{children:"#"}),(0,s.jsx)("th",{children:"SKU"}),(0,s.jsx)("th",{children:"Thumbnail"}),(0,s.jsx)("th",{children:"Name / Slug"}),(0,s.jsx)("th",{children:"Category"}),(0,s.jsx)("th",{children:"Price"}),(0,s.jsx)("th",{children:"Stock"}),(0,s.jsx)("th",{children:"Actions"})]})}),(0,s.jsx)("tbody",{children:e.map((n,r)=>{var o;const l=n._id||n.id||n.slug,c=function(e){if(!e)return null;if(e.thumbnail)return e.thumbnail;if(e.image)return e.image;if(e.images&&e.images.length){const t=e.images[0];return"string"===typeof t?t:t.url||null}return null}(n);return(0,s.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[(0,s.jsx)("td",{children:r+1}),(0,s.jsx)("td",{children:n.sku||"-"}),(0,s.jsx)("td",{children:c?(0,s.jsx)("img",{src:c,style:{width:64,height:64,borderRadius:4,objectFit:"cover"}}):(0,s.jsx)("div",{style:{width:64,height:64,background:"#eee",borderRadius:4}})}),(0,s.jsxs)("td",{children:[(0,s.jsx)("div",{style:{fontWeight:700},children:n.title}),(0,s.jsx)("div",{children:n.slug})]}),(0,s.jsx)("td",{children:n.category||"-"}),(0,s.jsx)("td",{children:null!==(o=n.price)&&void 0!==o?o:"-"}),(0,s.jsx)("td",{children:p(n)}),(0,s.jsx)("td",{children:(0,s.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,s.jsx)(i.N_,{to:"/admin/products/".concat(l),children:(0,s.jsx)("button",{children:"Edit"})}),(0,s.jsx)("button",{onClick:()=>async function(n){if(!window.confirm("Delete this product? This action cannot be undone."))return;const r=e;t(r.filter(e=>(e._id||e.id)!==n)),u("Deleting...");try{var i;const e=await a.A.delete("/api/products/".concat(n));var s;if(null===(i=e.data)||void 0===i||!i.success)throw new Error((null===(s=e.data)||void 0===s?void 0:s.message)||"Delete failed");u("Deleted"),setTimeout(()=>u(""),1500)}catch(o){console.error("Delete error",o),t(r),u("Delete failed: "+(o.message||"")),setTimeout(()=>u(""),2e3)}}(l),children:"Delete"}),(0,s.jsx)("button",{onClick:()=>window.open("/product/".concat(n.slug),"_blank"),children:"Preview"})]})})]},l)})})]})})]}):(0,s.jsxs)("div",{style:{padding:20},children:[(0,s.jsx)("h2",{children:"Admin \u2014 Products"}),(0,s.jsx)("p",{children:"No products found."}),(0,s.jsx)(i.N_,{to:"/admin/products/new",children:(0,s.jsx)("button",{children:"+ Add product"})})]})}var d=n(9379);const u={white:"#FFFFFF",silver:"#C0C0C0",gray:"#808080",black:"#000000",red:"#FF0000",maroon:"#800000",yellow:"#FFFF00",olive:"#808000",lime:"#00FF00",green:"#008000",aqua:"#00FFFF",teal:"#008080",blue:"#0000FF",navy:"#000080",fuchsia:"#FF00FF",purple:"#800080",pink:"#FFC0CB",brown:"#A52A2A",orange:"#FFA500",gold:"#FFD700",peach:"#FFDAB9",mustard:"#FFDB58",coral:"#FF7F50"};function p(e){if(!e)return{r:0,g:0,b:0};const t=e.replace("#","").trim();return 3===t.length?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16)}:{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16)}}function h(e){return e?String(e).toLowerCase().trim().replace(/['"]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").replace(/-+/g,"-"):""}function g(){return String((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"").replace(/[^a-z0-9]/gi,"").toUpperCase()}function m(e){let{brand:t,category:n,title:r}=e;const i=g(t||""),s=g(n||"");let o="KPL";if(i&&s){const e=i.slice(0,3),t=s.slice(0,3);o="".concat(e,"-").concat(t)}else i?o="".concat(i.slice(0,3)):s?o="".concat(s.slice(0,3)):r&&(o=g(r).slice(0,3)||"KPL");const l=String(Math.abs(Date.now())%1e3).padStart(3,"0");return"".concat(o,"-").concat(l)}function y(){const{id:e}=(0,i.g)(),t=(0,i.Zp)(),n=(0,r.useRef)(null),o=(0,r.useRef)(null),[l,c]=(0,r.useState)(null),[g,y]=(0,r.useState)(!0),[x,f]=(0,r.useState)(!1),[j,v]=(0,r.useState)({title:"",slug:"",price:"",mrp:"",stock:"",sku:"",brand:"",category:"",videoUrl:"",colors:"",sizes:"",description:"",isPublished:!1}),[b,w]=(0,r.useState)(!1),[k,F]=(0,r.useState)(!1),[C,S]=(0,r.useState)([]),[A,U]=(0,r.useState)({}),[T,P]=(0,r.useState)([]),[L,R]=(0,r.useState)([]),B=e=>{if(!e)return"";const t=e.trim();if(/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/.test(t)){const e=t.replace("#",""),n=3===e.length?e[0]+e[0]+e[1]+e[1]+e[2]+e[2]:e;return"#".concat(n.toUpperCase())}const n=t.toLowerCase();return u[n]?u[n].toUpperCase():t};function E(e){const{name:t,value:n,checked:r}=e.target;if("isPublished"===t)v(e=>(0,d.A)((0,d.A)({},e),{},{isPublished:!!r}));else if("slug"===t&&w(!0),"sku"===t&&F(!0),v(e=>(0,d.A)((0,d.A)({},e),{},{[t]:n})),"colors"===t){const e=(i=n,i?i.split(",").map(e=>e.trim()).filter(Boolean):[]).map(e=>B(e));R(e)}var i}return(0,r.useEffect)(()=>{let t=!1;if(!e)return y(!1),S([]),U({}),R([]),v(e=>{const t=(0,d.A)({},e);return!t.slug&&t.title&&(t.slug=h(t.title)),t.sku||(t.sku=m({brand:t.brand,category:t.category,title:t.title})),t}),()=>{t=!0};function n(e){v({title:e.title||"",slug:e.slug||"",price:e.price||"",mrp:e.mrp||"",stock:e.stock||"",sku:e.sku||"",brand:e.brand||"",category:e.category||"",videoUrl:e.videoUrl||"",colors:Array.isArray(e.colors)?e.colors.join(", "):e.colors||"",sizes:Array.isArray(e.sizes)?e.sizes.join(", "):e.sizes||"",description:e.description||"",isPublished:!!e.isPublished}),e.slug&&w(!0),e.sku&&F(!0);const t=Array.isArray(e.images)?e.images.map(e=>"string"===typeof e?e:e.url||e):[];S(t);const n={};t.forEach(e=>n[e]=!0),U(n);const r=(Array.isArray(e.colors)?e.colors:e.colors?e.colors.split(",").map(e=>e.trim()):[]).map(e=>B(e));R(r)}return async function(){try{y(!0);try{const t=await a.A.get("/api/products/".concat(e));if(t&&t.data){const e=t.data.product||t.data.success&&t.data.products&&t.data.products[0]||t.data;if(e&&"object"===typeof e)return n(e),void y(!1)}}catch(r){console.warn("Direct GET failed, falling back to list",r&&r.response?r.response.status:r.message)}try{const t=await a.A.get("/api/products"),r=t&&t.data&&(t.data.products||t.data)||[];if(Array.isArray(r)&&r.length){let t=r.find(t=>String(t._id)===String(e));if(t||(t=r.find(t=>t.slug===e||String(t.slug)===String(e))),t)return n(t),void y(!1)}alert("Product not found on server.")}catch(r){console.error("Products list fallback failed",r),alert("Failed to load product list fallback. See console.")}}finally{t||y(!1)}}(),()=>{t=!0,T.forEach(e=>e.previewUrl&&URL.revokeObjectURL(e.previewUrl))}},[e]),(0,r.useEffect)(()=>{const e=L.map(e=>{if(!e)return"";const t=Object.entries(u).find(t=>{let[,n]=t;return n.toUpperCase()===e.toUpperCase()});return t?t[0].toUpperCase():e}).filter(Boolean).join(", ");v(t=>(0,d.A)((0,d.A)({},t),{},{colors:e}))},[L]),(0,r.useEffect)(()=>{b||v(e=>(0,d.A)((0,d.A)({},e),{},{slug:h(e.title||"")}))},[j.title,b]),(0,r.useEffect)(()=>{if(!k){const e=m({brand:j.brand,category:j.category,title:j.title});v(t=>(0,d.A)((0,d.A)({},t),{},{sku:e}))}},[j.brand,j.category,j.title,k]),g?(0,s.jsx)("div",{children:"Loading..."}):(0,s.jsxs)("div",{style:{display:"flex",gap:40,padding:12},children:[(0,s.jsxs)("form",{onSubmit:async function(n){n.preventDefault(),f(!0);try{const n={title:j.title,slug:j.slug,price:Number(j.price)||0,mrp:Number(j.mrp)||0,stock:Number(j.stock)||0,sku:j.sku,brand:j.brand,category:j.category,videoUrl:j.videoUrl,description:j.description,isPublished:!!j.isPublished,colors:L.map(e=>e),sizes:j.sizes?j.sizes.split(",").map(e=>e.trim()).filter(Boolean):[]};let i=e;if(!i){n.slug||(n.slug=h(n.title||"")),n.sku||(n.sku=m({brand:n.brand,category:n.category,title:n.title}));const e=await async function(e){const t={title:e.title||"Untitled product",slug:e.slug||"",price:Number(e.price)||0,mrp:Number(e.mrp)||0,stock:Number(e.stock)||0,sku:e.sku||"",brand:e.brand||"",category:e.category||"",videoUrl:e.videoUrl||"",description:e.description||"",isPublished:!!e.isPublished,colors:e.colors||[],sizes:e.sizes||[],images:[]},n=await a.A.post("/api/products",t),r=n&&n.data?n.data.product||n.data:null;if(!r)throw new Error("Create product failed: no product returned");return r}(n);if(i=e._id||e.id||e._id&&e._id.toString(),!i)throw new Error("Could not obtain new product id from create response");v(t=>(0,d.A)((0,d.A)({},t),{},{slug:e.slug||t.slug,sku:e.sku||t.sku}))}let s=[];if(T.length)try{s=await async function(e){var t,n,r,i;if(!T.length)return[];if(!e)throw new Error("Missing product id for upload");const s=new FormData;T.forEach(e=>s.append("images",e.file));const o=[{method:"put",url:"/api/uploadRoutes/".concat(e,"/upload")},{method:"post",url:"/api/uploadRoutes/upload"}];let l=null;for(const u of o)try{let e;e="put"===u.method?await a.A.put(u.url,s,{headers:{"Content-Type":"multipart/form-data"}}):await a.A.post(u.url,s,{headers:{"Content-Type":"multipart/form-data"}});const t=e.data||{};return(Array.isArray(t.uploaded)&&t.uploaded||(t.url?[{url:t.url}]:[])).map(e=>e.url)}catch(d){var c;l=d,console.warn("UPLOAD FAIL @ ".concat(u.url),null===d||void 0===d||null===(c=d.response)||void 0===c?void 0:c.status)}throw new Error((null===(t=l)||void 0===t||null===(n=t.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.error)||(null===(i=l)||void 0===i?void 0:i.message)||"Upload failed")}(i)}catch(r){throw console.error("Upload request failed",r),new Error("Upload request failed: "+(r.message||r))}const o=[...C.filter(e=>A[e])];s.forEach(e=>{o.includes(e)||o.push(e)});const l=(0,d.A)((0,d.A)({},n),{},{images:o}),c=[{url:"/api/products/".concat(i),desc:"public"},{url:"/api/admin/product/".concat(i),desc:"admin (api/admin/product)"},{url:"/api/admin/products/".concat(i),desc:"admin (api/admin/products)"},{url:"/api/adminProduct/products/".concat(i),desc:"adminProduct (api/adminProduct/products)"}];let u=null,p=null;for(const e of c)try{const t=await a.A.put(e.url,l);if(t&&t.status>=200&&t.status<300){u=t;break}}catch(r){p=r,console.warn("[save] PUT ".concat(e.url," failed"),r&&r.response&&r.response.status?r.response.status:r.message)}if(!u){console.error("All update attempts failed",p);const e=p&&p.response&&p.response.data&&p.response.data.message?p.response.data.message:p&&p.message||"Save failed on all attempted update endpoints";throw new Error(e)}T.forEach(e=>e.previewUrl&&URL.revokeObjectURL(e.previewUrl)),P([]);const g=u.data.product||u.data,y=Array.isArray(g.images)?g.images.map(e=>"string"===typeof e?e:e.url||e):[];S(y);const x={};y.forEach(e=>x[e]=!0),U(x),alert(e?"Product updated.":"Product created and saved."),!e&&i&&t("/admin/products/".concat(i,"/edit"))}catch(r){console.error("Save error",r);const e=r&&r.response&&r.response.data&&(r.response.data.message||JSON.stringify(r.response.data))||r&&r.message||"Save failed";alert(e)}finally{f(!1)}},style:{width:"40%"},children:[(0,s.jsx)("div",{style:{marginBottom:10},children:(0,s.jsx)("button",{type:"button",onClick:()=>t("/admin/products"),children:"Back to products"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"Title"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{name:"title",value:j.title,onChange:E,style:{width:"100%"}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"Slug"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{name:"slug",value:j.slug,onChange:e=>{E(e),w(!0)},style:{width:"100%"}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"Price"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{name:"price",value:j.price,onChange:E,style:{width:"100%"}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"MRP"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{name:"mrp",value:j.mrp,onChange:E,style:{width:"100%"}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"Stock"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{name:"stock",value:j.stock,onChange:E,style:{width:"100%"}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"SKU"}),(0,s.jsx)("br",{}),(0,s.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,s.jsx)("input",{name:"sku",value:j.sku,onChange:e=>{E(e),F(!0)},style:{width:"100%"}}),(0,s.jsx)("button",{type:"button",onClick:function(){const e=m({brand:j.brand,category:j.category,title:j.title});v(t=>(0,d.A)((0,d.A)({},t),{},{sku:e})),F(!0)},children:"Generate SKU"})]}),(0,s.jsx)("div",{style:{fontSize:12,color:"#555",marginTop:6},children:"Format: BRAND-CTG-XXX or fallback KPL-XXX (XXX = 3-digit counter)"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"Brand"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{name:"brand",value:j.brand,onChange:E,style:{width:"100%"}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"Category"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{name:"category",value:j.category,onChange:E,style:{width:"100%"}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"Video URL (YouTube)"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{name:"videoUrl",value:j.videoUrl,onChange:E,style:{width:"100%"}}),(0,s.jsx)("div",{style:{fontSize:12,marginTop:6,color:"#555"},children:"Paste YouTube link (example: https://youtu.be/VIDEOID or https://www.youtube.com/watch?v=VIDEOID)"})]}),(0,s.jsxs)("div",{style:{marginTop:12},children:[(0,s.jsx)("label",{children:"Colors (comma-separated)"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{name:"colors",value:j.colors,onChange:E,style:{width:"100%"}}),(0,s.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginTop:10,alignItems:"center"},children:[L.map((e,t)=>{const n=/^#([0-9A-F]{6})$/i.test(String(e).trim()),r=n?e:"#EEE",i=n?function(e){try{const t=p(e);let n=null,r=1/0;return Object.entries(u).forEach(e=>{let[i,s]=e;const o=p(s),l=t.r-o.r,a=t.g-o.g,c=t.b-o.b,d=l*l+a*a+c*c;d<r&&(r=d,n=i)}),n||""}catch(t){return""}}(e):String(e)||"";return(0,s.jsxs)("div",{style:{textAlign:"center"},children:[(0,s.jsx)("div",{title:String(e),onClick:()=>function(e){if(c(e),o.current){const t=L[e]||"#FFFFFF",n=B(t)||"#FFFFFF";o.current.value=n,o.current.click()}}(t),style:{width:48,height:48,borderRadius:6,border:"1px solid #ccc",boxShadow:"0 1px 6px rgba(0,0,0,0.12)",background:r,cursor:"pointer"}}),(0,s.jsx)("div",{style:{fontSize:12,marginTop:6,maxWidth:80,wordBreak:"break-word"},children:i||String(e).slice(0,12)}),(0,s.jsx)("div",{style:{marginTop:6},children:(0,s.jsx)("button",{type:"button",onClick:()=>function(e){R(t=>t.filter((t,n)=>n!==e))}(t),children:"Remove"})})]},t)}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"button",onClick:function(){R(e=>[...e,"#FFFFFF"])},children:"+ Add color"})}),(0,s.jsx)("input",{ref:o,type:"color",style:{display:"none"},onChange:function(e){const t=e.target.value,n=l;c(null),null!=n&&R(e=>{const r=[...e];return r[n]=t.toUpperCase(),r})},"aria-hidden":"true"})]})]}),(0,s.jsxs)("div",{style:{marginTop:12},children:[(0,s.jsx)("label",{children:"Sizes (comma-separated)"}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{name:"sizes",value:j.sizes,onChange:E,style:{width:"100%"}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"Description"}),(0,s.jsx)("br",{}),(0,s.jsx)("textarea",{name:"description",value:j.description,onChange:E,rows:6,style:{width:"100%"}})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:[(0,s.jsx)("input",{name:"isPublished",type:"checkbox",checked:j.isPublished,onChange:E})," Published"]})}),(0,s.jsxs)("div",{style:{marginTop:8},children:[(0,s.jsx)("button",{type:"submit",disabled:x,children:x?"Saving...":e?"Save":"Create product"}),(0,s.jsx)("button",{type:"button",onClick:()=>t("/admin/products"),children:"Cancel"})]})]}),(0,s.jsxs)("div",{style:{width:"50%"},children:[(0,s.jsx)("h3",{children:"Existing Images"}),(0,s.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[C.map((e,t)=>(0,s.jsxs)("div",{style:{textAlign:"center",width:120},children:[(0,s.jsx)("img",{src:e,alt:"img-".concat(t),style:{width:100,height:100,objectFit:"cover"}}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:[(0,s.jsx)("input",{type:"checkbox",checked:!!A[e],onChange:()=>function(e){U(t=>(0,d.A)((0,d.A)({},t),{},{[e]:!t[e]}))}(e)})," Keep"]})}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"button",onClick:()=>{U(t=>(0,d.A)((0,d.A)({},t),{},{[e]:!1}))},children:"Remove"})})]},e)),0===C.length&&(0,s.jsx)("div",{children:"No existing images"})]}),(0,s.jsx)("h3",{style:{marginTop:16},children:"Add Images"}),(0,s.jsx)("input",{ref:n,type:"file",multiple:!0,onChange:function(e){const t=Array.from(e.target.files||[]);if(!t.length)return;const r=t.map(e=>({file:e,previewUrl:URL.createObjectURL(e)}));P(e=>[...e,...r]),n.current&&(n.current.value="")}}),(0,s.jsxs)("div",{style:{marginTop:8,display:"flex",gap:12,flexWrap:"wrap"},children:[T.map((e,t)=>(0,s.jsxs)("div",{style:{textAlign:"center",width:120},children:[(0,s.jsx)("img",{src:e.previewUrl,alt:"preview-".concat(t),style:{width:100,height:100,objectFit:"cover"}}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"button",onClick:()=>{return e=t,void P(t=>{const n=[...t],r=n.splice(e,1)[0];return r&&r.previewUrl&&URL.revokeObjectURL(r.previewUrl),n});var e},children:"Remove"})})]},e.previewUrl+t)),0===T.length&&(0,s.jsx)("div",{children:"No files chosen"})]}),(0,s.jsxs)("div",{style:{marginTop:20},children:[(0,s.jsx)("h4",{children:"Video preview"}),j.videoUrl?(()=>{const e=function(e){if(!e)return null;try{const t=e.trim(),n=t.match(/[?&]v=([^&]+)/);if(n)return"https://www.youtube.com/embed/".concat(n[1]);const r=t.match(/youtu\.be\/([^?&]+)/);return r?"https://www.youtube.com/embed/".concat(r[1]):t.includes("youtube.com/embed/")?t:null}catch(t){return null}}(j.videoUrl);return e?(0,s.jsx)("div",{style:{width:"100%",height:250},children:(0,s.jsx)("iframe",{title:"video-preview",src:e,style:{width:"100%",height:"100%",border:"none"},allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}):(0,s.jsx)("div",{children:"Unsupported video URL (currently only YouTube links are previewed)."})})():(0,s.jsx)("div",{children:"No video URL provided"})]})]})]})}const x={white:"#FFFFFF",silver:"#C0C0C0",gray:"#808080",black:"#000000",red:"#FF0000",maroon:"#800000",yellow:"#FFFF00",olive:"#808000",lime:"#00FF00",green:"#008000",aqua:"#00FFFF",teal:"#008080",blue:"#0000FF",navy:"#000080",fuchsia:"#FF00FF",purple:"#800080",pink:"#FFC0CB",brown:"#A52A2A",orange:"#FFA500",gold:"#FFD700",peach:"#FFDAB9",mustard:"#FFDB58",coral:"#FF7F50","#1026CB":"blue","#1A84C7":"teal","#E40C0C":"red","#010913":"black","#584141":"brown"};function f(e){if(!e)return null;const t=e.replace("#","").trim(),n=3===t.length?t.split("").map(e=>e+e).join(""):t;return 6!==n.length?null:{r:parseInt(n.slice(0,2),16),g:parseInt(n.slice(2,4),16),b:parseInt(n.slice(4,6),16)}}function j(e){if(!e)return"";const t=String(e).trim();if(/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/.test(t)){const e=t.replace("#",""),n=3===e.length?e.split("").map(e=>e+e).join(""):e;return"#".concat(n.toUpperCase())}const n=t.toLowerCase();return x[n]?x[n].toUpperCase():/^[0-9A-Fa-f]{6}$/.test(t)?"#".concat(t.toUpperCase()):t}function v(){return String((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"").replace(/[^a-z0-9]/gi,"").toUpperCase()}function b(e){let{brand:t,category:n,title:r}=e;const i=v(t||""),s=v(n||"");let o="KPL";if(i&&s){const e=i.slice(0,3),t=s.slice(0,3);o="".concat(e,"-").concat(t)}else i?o="".concat(i.slice(0,3)):s?o="".concat(s.slice(0,3)):r&&(o=v(r).slice(0,3)||"KPL");const l=String(Math.abs(Date.now())%1e3).padStart(3,"0");return"".concat(o,"-").concat(l)}function w(){const e=(0,i.Zp)(),[t,n]=(0,r.useState)(""),[o,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[u,p]=(0,r.useState)(""),[h,g]=(0,r.useState)(""),[m,y]=(0,r.useState)(""),[v,w]=(0,r.useState)(""),[k,F]=(0,r.useState)(""),[C,S]=(0,r.useState)(""),[A,U]=(0,r.useState)(""),[T,P]=(0,r.useState)(!1),[L,R]=(0,r.useState)(!1),[B,E]=(0,r.useState)(""),[N,D]=(0,r.useState)([]),O=(0,r.useRef)(null),[I,z]=(0,r.useState)(null),[X,_]=(0,r.useState)(""),W=(0,r.useRef)(null),[q,K]=(0,r.useState)([]),[$,V]=(0,r.useState)([]),[Y,G]=(0,r.useState)(!1),[M,J]=(0,r.useState)(!1),[Z,H]=(0,r.useState)("");async function Q(){if(!q.length)return[];const e=new FormData;q.forEach(t=>e.append("files",t.file)),G(!0);try{const t=await a.A.post("/api/uploadRoutes/upload",e,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}),n=(null===t||void 0===t?void 0:t.data)||{};let r=[];Array.isArray(n.uploaded)?r=n.uploaded:n.url&&(r=[n]);const i=r.map(e=>e.url).filter(Boolean),s=r.map((e,t)=>({filename:e.filename||"img-".concat(t),url:e.url}));return V(e=>[...e,...s]),K([]),i}catch(t){throw console.error("Upload failed",t),t}finally{G(!1)}}(0,r.useEffect)(()=>{const e=B?B.split(",").map(e=>e.trim()).filter(Boolean).map(e=>j(e)):[];D(e)},[B]),(0,r.useEffect)(()=>{const e=N.map(e=>{if(!e)return"";String(e).toLowerCase();const t=Object.entries(x).find(t=>{let[,n]=t;return n.toUpperCase()===String(e).toUpperCase()});return t?t[0].toUpperCase():e}).filter(Boolean).join(", ");E(e)},[N]),(0,r.useEffect)(()=>{if(!T){const n=(e=t)?String(e).toLowerCase().trim().replace(/['"]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").replace(/-+/g,"-"):"";l(n)}var e},[t]),(0,r.useEffect)(()=>{if(!L){const e=b({brand:k||t,category:C});d(e)}},[k,C,t]);const ee=function(e){if(!e||"string"!==typeof e)return null;const t=e.trim();try{const e=new URL(t,window.location.origin),n=e.hostname.toLowerCase();if(n.includes("youtube.com")){if(e.pathname.startsWith("/embed/"))return"https://www.youtube.com".concat(e.pathname).concat(e.search||"");const t=e.searchParams.get("v");if(t)return"https://www.youtube.com/embed/".concat(t)}if(n.includes("youtu.be")){const t=e.pathname.replace("/","");if(t)return"https://www.youtube.com/embed/".concat(t)}}catch(n){const e=t.match(/^[A-Za-z0-9_-]{8,}$/);if(e)return"https://www.youtube.com/embed/".concat(e[0])}return null}(A);return(0,s.jsxs)("div",{style:{padding:20},children:[(0,s.jsx)("div",{style:{marginBottom:12},children:(0,s.jsx)("button",{type:"button",onClick:()=>e("/admin/products"),style:{padding:"6px 10px"},children:"Back to products"})}),(0,s.jsx)("h1",{children:"Add New Product"}),(0,s.jsxs)("form",{onSubmit:async function(n){var r;null===n||void 0===n||null===(r=n.preventDefault)||void 0===r||r.call(n),H(""),J(!0);try{let n=[];if(q.length&&(n=await Q(),0===n.length))throw new Error("No urls returned from upload");const r=$&&$.length?$.map(e=>e.url):[];n&&n.length&&n.forEach(e=>{r.includes(e)||r.push(e)});const i={title:t,slug:o,sku:c,description:u,price:Number(h)||0,mrp:Number(m)||0,stock:Number(v)||0,brand:k,category:C,videoUrl:A||"",colors:N.map(e=>e),sizes:X?X.split(",").map(e=>e.trim()).filter(Boolean):[],images:r},s=await a.A.post("/api/products",i,{withCredentials:!0}),l=s&&s.data?s.data:{};if(!l||!(l.success||l._id||l.id||l.product))throw console.error("Create product unexpected response",l),new Error("Create failed, check server response");{H("Product created.");const t=l.product||l;t._id||t.id||t.slug;e("/admin/products")}}catch(i){console.error("Create product error",i),H("Create failed: "+(i.message||String(i)))}finally{J(!1)}},children:[(0,s.jsxs)("div",{style:{marginBottom:8},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:4},children:"Title"}),(0,s.jsx)("input",{value:t,onChange:e=>n(e.target.value),style:{width:"100%"}})]}),(0,s.jsxs)("div",{style:{marginBottom:8},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:4},children:"Slug"}),(0,s.jsx)("input",{value:o,onChange:e=>{l(e.target.value),P(!0)},placeholder:"example-product-slug",style:{width:"100%"}})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:4},children:"Price (\u20b9)"}),(0,s.jsx)("input",{value:h,onChange:e=>g(e.target.value)})]}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:4},children:"MRP (\u20b9)"}),(0,s.jsx)("input",{value:m,onChange:e=>y(e.target.value)})]}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:4},children:"Stock"}),(0,s.jsx)("input",{value:v,onChange:e=>w(e.target.value)})]})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:12,marginTop:12},children:[(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:4},children:"SKU"}),(0,s.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,s.jsx)("input",{value:c,onChange:e=>{d(e.target.value),R(!0)}}),(0,s.jsx)("button",{type:"button",onClick:function(){const e=b({brand:k,category:C,title:t});d(e),R(!0)},children:"Generate SKU"})]}),(0,s.jsx)("div",{style:{fontSize:12,color:"#555",marginTop:6},children:"Format: BRAND-CTG-XXX or fallback KPL-XXX (XXX = 3-digit counter)"})]}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:4},children:"Brand"}),(0,s.jsx)("input",{value:k,onChange:e=>F(e.target.value)})]}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:4},children:"Category"}),(0,s.jsx)("input",{value:C,onChange:e=>S(e.target.value)})]})]}),(0,s.jsxs)("div",{style:{marginTop:12},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:4},children:"Description"}),(0,s.jsx)("textarea",{value:u,onChange:e=>p(e.target.value),rows:5,style:{width:"100%"}})]}),(0,s.jsxs)("div",{style:{marginTop:12},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:6},children:"Colors (comma-separated)"}),(0,s.jsx)("input",{value:B,onChange:e=>E(e.target.value),placeholder:"#1026CB, #1A84C7, red",style:{width:"100%"}}),(0,s.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginTop:10,alignItems:"center"},children:[N.map((e,t)=>{const n=/^#([0-9A-Fa-f]{6})$/.test(String(e).trim()),r=n?e:"#EEE",i=n&&function(e){try{const t=f(e);if(!t)return e;let n=null,r=1/0;for(const[e,i]of Object.entries(x)){const s=f(j(i));if(!s)continue;const o=(s.r-t.r)**2+(s.g-t.g)**2+(s.b-t.b)**2;o<r&&(r=o,n=e)}return n?r>25600?e:n:e}catch(t){return e}}(e)||e;return(0,s.jsxs)("div",{style:{textAlign:"center",minWidth:72},children:[(0,s.jsx)("div",{title:String(e),onClick:()=>function(e){if(z(e),O.current){const t=N[e]||"#FFFFFF",n=/^#([0-9A-Fa-f]{6})$/.test(String(t))?t:"#FFFFFF";O.current.value=n,O.current.click()}}(t),style:{width:48,height:48,borderRadius:6,border:"1px solid #ccc",boxShadow:"0 1px 6px rgba(0,0,0,0.12)",background:r,cursor:"pointer"}}),(0,s.jsx)("div",{style:{fontSize:12,marginTop:6,maxWidth:80,wordBreak:"break-word"},children:i}),(0,s.jsx)("div",{style:{marginTop:6},children:(0,s.jsx)("button",{type:"button",onClick:()=>function(e){D(t=>t.filter((t,n)=>n!==e))}(t),children:"Remove"})})]},t)}),(0,s.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,s.jsx)("button",{type:"button",onClick:function(){D(e=>[...e,"#FFFFFF"])},children:"+ Add color"})}),(0,s.jsx)("input",{ref:O,type:"color",style:{display:"none"},onChange:function(e){const t=e.target.value,n=I;z(null),null!=n&&D(e=>{const r=[...e];return r[n]=t.toUpperCase(),r})},"aria-hidden":!0})]})]}),(0,s.jsxs)("div",{style:{marginTop:12},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:4},children:"Sizes (comma separated)"}),(0,s.jsx)("input",{value:X,onChange:e=>_(e.target.value),placeholder:"L, XL, XXL",style:{width:"100%"}})]}),(0,s.jsxs)("div",{style:{marginTop:12},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:4},children:"Video URL (YouTube)"}),(0,s.jsx)("input",{value:A,onChange:e=>U(e.target.value),style:{width:"100%"}}),(0,s.jsx)("div",{style:{fontSize:12,color:"#555",marginTop:6},children:"Paste YouTube link (example: https://youtu.be/VIDEOID or https://www.youtube.com/watch?v=VIDEOID)"}),(0,s.jsx)("div",{style:{marginTop:12},children:A?ee?(0,s.jsx)("div",{style:{width:420,maxWidth:"100%",height:220,border:"1px solid #eee",borderRadius:6,overflow:"hidden"},children:(0,s.jsx)("iframe",{title:"video-preview",width:"100%",height:"100%",src:ee,frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}):(0,s.jsx)("div",{style:{color:"#666"},children:"Unsupported video URL for inline preview (only YouTube links are embedded)."}):(0,s.jsx)("div",{style:{color:"#666"},children:"No video URL provided"})})]}),(0,s.jsx)("hr",{style:{margin:"12px 0"}}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:6},children:"Images (select one or more)"}),(0,s.jsxs)("div",{style:{margin:"8px 0"},children:[(0,s.jsx)("input",{ref:W,type:"file",multiple:!0,onChange:function(e){const t=Array.from(e.target.files||[]);if(!t.length)return;const n=t.map(e=>({file:e,previewUrl:URL.createObjectURL(e)}));K(e=>[...e,...n]),W.current&&(W.current.value="")}}),(0,s.jsx)("button",{type:"button",onClick:Q,disabled:Y,style:{marginLeft:8},children:Y?"Uploading\u2026":"Upload selected"})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:8},children:[q.map((e,t)=>(0,s.jsxs)("div",{style:{border:"1px solid #eee",padding:6,borderRadius:6},children:[(0,s.jsx)("img",{src:e.previewUrl,alt:"preview-".concat(t),style:{width:120,height:120,objectFit:"cover"}}),(0,s.jsx)("div",{style:{marginTop:6},children:(0,s.jsx)("button",{type:"button",onClick:()=>function(e){K(t=>{const n=[...t],r=n.splice(e,1)[0];return r&&r.previewUrl&&URL.revokeObjectURL(r.previewUrl),n})}(t),children:"Remove"})})]},e.previewUrl+t)),$.map((e,t)=>(0,s.jsxs)("div",{style:{border:"1px solid #eee",padding:6,borderRadius:6},children:[(0,s.jsx)("img",{src:e.url,alt:e.filename,style:{width:120,height:120,objectFit:"cover"}}),(0,s.jsx)("div",{style:{marginTop:6},children:(0,s.jsx)("button",{type:"button",onClick:()=>{return e=t,void V(t=>t.filter((t,n)=>n!==e));var e},children:"Remove"})})]},"up-".concat(t))),!q.length&&0===$.length&&(0,s.jsx)("div",{style:{color:"#666"},children:"No files chosen"})]})]}),(0,s.jsxs)("div",{style:{marginTop:16},children:[(0,s.jsx)("button",{type:"submit",disabled:M,children:M?"Saving...":"Create Product"}),(0,s.jsx)("button",{type:"button",onClick:()=>e(-1),style:{marginLeft:10},children:"Cancel"})]})]}),Z&&(0,s.jsx)("div",{style:{marginTop:12,color:"crimson",whiteSpace:"pre-wrap"},children:Z})]})}const k="https://api.seemati.in/api";function F(){const[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)(!0),[o,l]=(0,r.useState)(!1),[a,c]=(0,r.useState)(null),[d,u]=(0,r.useState)("");return(0,r.useEffect)(()=>{let e=!0;return async function(){try{const n=await fetch("".concat(k,"/admin-api/settings/announcements"));if(!n.ok)throw new Error("Failed to fetch");const r=await n.json();if(!e)return;t(Array.isArray(r.messages)?r.messages:[])}catch(n){e&&c("Unable to load announcements")}finally{e&&i(!1)}}(),()=>{e=!1}},[]),n?(0,s.jsx)("div",{children:"Loading announcements\u2026"}):(0,s.jsxs)("div",{style:{padding:12},children:[(0,s.jsx)("h3",{children:"Announcements"}),a&&(0,s.jsx)("div",{style:{color:"red"},children:a}),(0,s.jsxs)("div",{style:{marginBottom:8},children:[(0,s.jsx)("input",{value:d,onChange:e=>u(e.target.value),style:{width:"70%",padding:8},placeholder:"New announcement"}),(0,s.jsx)("button",{onClick:function(){const e=(d||"").trim();e&&(t(t=>[...t,e]),u(""))},style:{marginLeft:8,padding:"8px 12px"},children:"Add"})]}),(0,s.jsxs)("div",{children:[0===e.length&&(0,s.jsx)("div",{children:"No announcements"}),(0,s.jsx)("ul",{style:{listStyle:"none",padding:0},children:e.map((n,r)=>(0,s.jsxs)("li",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[(0,s.jsx)("div",{style:{flex:1},children:n}),(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{onClick:()=>{var e;(e=r)<=0||t(t=>{const n=[...t],[r]=n.splice(e,1);return n.splice(e-1,0,r),n})},disabled:0===r,children:"\u2191"}),(0,s.jsx)("button",{onClick:()=>{return e=r,void t(t=>{if(e>=t.length-1)return t;const n=[...t],[r]=n.splice(e,1);return n.splice(e+1,0,r),n});var e},disabled:r===e.length-1,style:{marginLeft:6},children:"\u2193"}),(0,s.jsx)("button",{onClick:()=>{return e=r,void t(t=>t.filter((t,n)=>n!==e));var e},style:{marginLeft:6},children:"Remove"})]})]},r))})]}),(0,s.jsx)("div",{style:{marginTop:12},children:(0,s.jsx)("button",{onClick:async function(){l(!0),c(null);try{const t=await fetch("".concat(k,"/admin-api/settings/announcements"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:e})});if(!t.ok){const e=await t.text();throw new Error(e||"Save failed")}alert("Announcements saved")}catch(t){console.error(t),c("Save failed")}finally{l(!1)}},disabled:o,style:{padding:"8px 14px"},children:o?"Saving\u2026":"Save announcements"})})]})}function C(){return(0,s.jsxs)("div",{children:[(0,s.jsx)("header",{style:{padding:20,borderBottom:"1px solid #eee"},children:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsx)("h1",{style:{margin:0},children:"Admin"}),(0,s.jsxs)("nav",{children:[(0,s.jsx)(i.N_,{to:"/admin/login",style:{marginRight:12},children:"Login"}),(0,s.jsx)(i.N_,{to:"/admin/products",style:{marginRight:12},children:"Products"}),(0,s.jsx)(i.N_,{to:"/admin/announcements",style:{marginRight:12},children:"Announcements"}),(0,s.jsx)(i.N_,{to:"/",children:"Back to site"})]})]})}),(0,s.jsx)("main",{style:{padding:20},children:(0,s.jsxs)(i.BV,{children:[(0,s.jsx)(i.qh,{path:"login",element:(0,s.jsx)(l,{})}),(0,s.jsx)(i.qh,{path:"products",element:(0,s.jsx)(c,{})}),(0,s.jsx)(i.qh,{path:"products/new",element:(0,s.jsx)(w,{})}),(0,s.jsx)(i.qh,{path:"products/:id",element:(0,s.jsx)(y,{})}),(0,s.jsx)(i.qh,{path:"announcements",element:(0,s.jsx)(F,{})}),(0,s.jsx)(i.qh,{path:"*",element:(0,s.jsx)(l,{})})]})})]})}}}]);
//# sourceMappingURL=57.d0c3b62a.chunk.js.map